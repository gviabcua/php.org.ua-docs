Серіалізація об'єктів

-   [« Об'єкти та посилання](language.oop5.references.html)
    
-   [Коваріантність та контраваріантність »](language.oop5.variance.html)
    
-   [PHP Manual](index.html)
    
-   [Классы и объекты](language.oop5.html)
    
-   Серіалізація об'єктів
    

## Серіалізація об'єктів

## Серіалізація об'єктів - збереження об'єктів між сесіями

Функція [serialize()](function.serialize.html) повертає рядкове подання будь-якого значення, яке може бути збережене у PHP. Функція [unserialize()](function.unserialize.html) може використовувати цей рядок для відновлення вихідного значення змінної. Використання серіалізації для збереження об'єкта збереже всі його змінні. Методи в об'єкті не будуть збережені лише ім'я класу.

Для того, щоб мати можливість виконати [unserialize()](function.unserialize.html) для об'єкта потрібно, щоб клас цього об'єкта був визначений заздалегідь. Тобто, якщо у вас є екземпляр класу А, і ви зробите його серіалізацію, ви отримаєте його рядкову виставу, яка містить значення всіх змінних, що містяться в ньому. Для того, щоб відновити об'єкт із рядка в іншому PHP-файлі, клас A повинен бути визначений заздалегідь. Це можна зробити, наприклад, шляхом збереження визначення класу A в окремий файл і підключити файл або використовувати функцію [splautoloadregister()](function.spl-autoload-register.html) для автоматичного з'єднання.

```php
<?php
// classa.inc:

  class A {
      public $one = 1;

      public function show_one() {
          echo $this->one;
      }
  }

// page1.php:

  include("classa.inc");

  $a = new A;
  $s = serialize($a);
  // сохраняем $s где-нибудь, откуда page2.php сможет его получить.
  file_put_contents('store', $s);

// page2.php:

  // это нужно для того, чтобы функция unserialize работала правильно.
  include("classa.inc");

  $s = file_get_contents('store');
  $a = unserialize($s);

  // теперь можно использовать метод show_one() объекта $a.
  $a->show_one();
?>
```

Якщо в програмі серіалізація об'єктів для подальшого використання, настійно рекомендується підключати визначення класу для цього об'єкта у всьому додатку. Невиконання цієї вимоги може призвести до того, що об'єкт буде десеріалізований без визначення класу, що призведе до того, що PHP буде використовувати для цього об'єкта клас **PHPIncompleteClassName**що не має методів і зробить об'єкт марним.

Тому, якщо у наведеному вище прикладі $a стало частиною сесії після запуску `session_register("a")`, ви повинні підключати файл `classa.inc` на всіх ваших сторінках, а не лише page1.php та page2.php.

Зверніть увагу, що, крім вищенаведеної поради, також можна підключитися до подій серіалізації та десеріалізації об'єкта за допомогою методів [sleep()](language.oop5.magic.html#object.sleep) і [wakeup()](language.oop5.magic.html#object.wakeup). Метод [sleep()](language.oop5.magic.html#object.sleep) також дозволяє серіалізувати лише деяке підмножина властивостей об'єкта.