Знайомство з генераторами

-   [« Генераторы](language.generators.html)
    
-   [Синтаксис генераторів »](language.generators.syntax.html)
    
-   [PHP Manual](index.html)
    
-   [Генераторы](language.generators.html)
    
-   Знайомство з генераторами
    

## Знайомство з генераторами

(PHP 5> = 5.5.0, PHP 7, PHP 8)

Генератори надають легкий спосіб реалізації простих [ітераторів](language.oop5.iterations.html) без використання додаткових ресурсів або складнощів, пов'язаних з реалізацією класу, що реалізує інтерфейс [Iterator](class.iterator.html)

Генератор дозволяє вам писати код, який використовує [foreach](control-structures.foreach.html) для перебору набору даних без необхідності створення масиву в пам'яті, що може призвести до перевищення ліміту пам'яті, або зажадає багато часу для його створення. Натомість, ви можете написати функцію-генератор, яка, по суті, є звичайною [функцією](functions.user-defined.html), за винятком того, що замість [возврата](functions.returning-values.html) єдиного значення, генератор може повертати ([yield](language.generators.syntax.html#control-structures.yield)) стільки разів, скільки необхідно для генерації значень, що дозволяють перебрати вихідний набір даних.

Наочним прикладом вищесказаного може послужити використання функції [range()](function.range.html) як генератор. Стандартна функція [range()](function.range.html) генерує масив, що складається із значень, і повертає його, що може призвести до генерації величезних масивів даних. Наприклад, виклик **range(0, 1000000)** призведе до використання понад 100 МБ оперативної пам'яті.

Як альтернатива ми можемо створити генератор `xrange()`, який використовує пам'ять тільки для створення об'єкта [Iterator](class.iterator.html) та збереження поточного стану, що вимагатиме не більше 1 кілобайта пам'яті.

**Приклад #1 Реалізація [range()](function.range.html) як генератора**

```php
<?php
function xrange($start, $limit, $step = 1) {
    if ($start <= $limit) {
        if ($step <= 0) {
            throw new LogicException('Шаг должен быть положительным');
        }

        for ($i = $start; $i <= $limit; $i += $step) {
            yield $i;
        }
    } else {
        if ($step >= 0) {
            throw new LogicException('Шаг должен быть отрицательным');
        }

        for ($i = $start; $i >= $limit; $i += $step) {
            yield $i;
        }
    }
}

/* Обратите внимание, что и range() и xrange() дадут один и тот же вывод */

echo 'Нечётные однозначные числа с помощью range():  ';
foreach (range(1, 9, 2) as $number) {
    echo "$number ";
}
echo "\n";

echo 'Нечётные однозначные числа с помощью xrange(): ';
foreach (xrange(1, 9, 2) as $number) {
    echo "$number ";
}
?>
```

Результат виконання цього прикладу:

```
Нечётные однозначные числа с помощью range():  1 3 5 7 9
Нечётные однозначные числа с помощью xrange(): 1 3 5 7 9
```

### Об'єкт [Generator](class.generator.html)

Коли функція генератор викликається, вона поверне об'єкт вбудованого класу [Generator](class.generator.html). Цей об'єкт реалізує інтерфейс [Iterator](class.iterator.html), стане односпрямованим об'єктом ітератора та надасть методи, за допомогою яких можна керувати його станом, включаючи передачу до нього та повернення з нього значень.