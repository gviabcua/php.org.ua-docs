PHP та COM

-   [« PHP и HTML](faq.html.md)
    
-   [Різні питання »](faq.misc.md)
    
-   [PHP Manual](index.md)
    
-   [ЧАВО](faq.md)
    
-   PHP та COM
    

# PHP та COM

PHP може бути використаний для доступу до об'єктів COM та DCOM на платформах Win32.

1.  [Я зібрав DLL для деяких обчислень. Чи можна запустити цю DLL із PHP?](#faq.com.q1)
2.  [Что значит 'Unsupported variant type: xxxx (0xxxxx)'?](#faq.com.q2)
3.  [Чи можливе маніпулювання візуальними об'єктами в PHP?](#faq.com.q3)
4.  [Чи можу я зберігати об'єкт COM у сесії?](#faq.com.q4)
5.  [Як я можу зловити помилки COM?](#faq.com.q5)
6.  [Чи можна генерувати DLL-файли з PHP-скриптів так, як це можна робити у Perl?](#faq.com.q6)
7.  [Что значит 'Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}'?](#faq.com.q7)
8.  [Як можна запускати COM-об'єкти з віддаленого сервера?](#faq.com.q8)
9.  [Я получаю 'DCOM is disabled in C:path...scriptname.php on line 6', що робити?](#faq.com.q9)
10.  [Чи можливо за допомогою PHP завантажити/маніпулювати об'єктом ActiveX на сторінці?](#faq.com.q10)
11.  [Чи можливо отримати екземпляр компонента, що виконується?](#faq.com.q11)
12.  [Чи є спосіб обробити подію, надіслану об'єктом COM?](#faq.com.q12)
13.  [У мене виникають проблеми при спробі викликати метод об'єкта COM, який надає більш ніж один інтерфейс. Що я можу зробити?](#faq.com.q13)
14.  [Отже, PHP працює з COM, як щодо COM+?](#faq.com.q14)
15.  [Якщо PHP може маніпулювати COM-об'єктами, чи можна уявити використання MTS для управління ресурсами компонентів у з'єднанні з PHP?](#faq.com.q15)

**Я зібрав DLL для деяких обчислень. Чи можна запустити цю DLL із PHP?**

Якщо це проста DLL, то поки що немає можливості викликати її з PHP. Якщо DLL містить COM-сервер, ви можете отримати доступ до неї, якщо вона реалізує інтерфейс IDispatch.

**Що означає 'Unsupported variant type: xxxx (0xxxxx)'?**

Існують дюжини типів VARIANT та їх комбінацій. Більшість із них уже підтримуються, але дещо все ще не реалізовані. Масиви підтримуються в повному обсязі. Тільки одновимірні індексовані масиви можуть передаватися між PHP та COM. Якщо ви виявите типи, що не підтримуються, будь ласка, повідомте про них як про помилку (якщо це ще не зроблено) і надайте всю доступну інформацію.

**Чи можливе маніпулювання візуальними об'єктами в PHP?**

Загалом так, але оскільки PHP в основному використовується як скриптова мова для Інтернету і виконується в контексті Інтернет-сервера, то візуальні об'єкти ніколи не з'являться на робочому столі сервера. Якщо ви використовуєте PHP як скрипт для програм, наприклад у зв'язці з PHP-GTK, тоді немає обмежень на доступ та маніпулювання візуальними об'єктами через COM.

**Чи можу я зберігати об'єкт COM у сесії?**

Ні не можете. Оскільки екземпляри COM розглядаються як ресурси, то вони доступні лише у контексті одного скрипта.

**Як я можу зловити помилки COM?**

Модуль COM викидає виняток `com_exception`, яке ви можете перехопити і потім перевірити у нього поле `code`, щоб зрозуміти, що робити далі.

**Чи можна генерувати DLL-файли з PHP-скриптів так, як це можна робити у Perl?**

Ні, на жаль, такий засіб недоступний для PHP.

**Що означає 'Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}'?**

Ця помилка може виникнути з різних причин:

-   неправильний CLSID
-   відсутня запитана DLL
-   запитаний компонент не реалізує інтерфейс IDispatch

**Як можна запускати COM-об'єкти з віддаленого сервера?**

Точно так само, як ви запускаєте локальні об'єкти. Вам тільки треба передати IP дистанційної машини як другий параметр конструктора COM.

Переконайтеся, що у вашому php.ini ви встановили [com.allowdcom](com.configuration.html#ini.com.allow-dcom)`=`**`true`**

**Я отримую 'DCOM is disabled in C:path...scriptname.php on line 6', що робити?**

Відредагуйте ваш php.ini та встановіть [com.allowdcom](com.configuration.html#ini.com.allow-dcom)`=`**`true`**

**Чи можливо за допомогою PHP завантажити/маніпулювати об'єктом ActiveX на сторінці?**

PHP тут не до того. Об'єкти ActiveX завантажуються на стороні клієнта, якщо їх запросили з HTML документа. Зв'язку з PHP-скриптом тут немає і, отже, пряма взаємодія із серверною стороною неможлива.

**Чи можливо отримати екземпляр компонента, що виконується?**

Це можливо за допомогою монікерів (monikers). Якщо ви хочете отримати кілька посилань на той самий екземпляр Word, ви можете створити цей екземпляр як показано:

```php
<?php
$word = new COM("C:\docs\word.doc");
?>
```

Це створить новий екземпляр, якщо немає доступного екземпляра або буде повернуто посилання на екземпляр, якщо такий доступний.

**Чи є спосіб обробити подію, надіслану об'єктом COM?**

Використовуючи [comeventsink()](function.com-event-sink.html) ви можете визначити приймач події та прив'язати його. Ви можете змусити PHP згенерувати скелет класу приймача подій, використовуючи [comprinttypeinfo()](function.com-print-typeinfo.html)

**У мене виникають проблеми при спробі викликати метод об'єкта COM, який надає більш ніж один інтерфейс. Що я можу зробити?**

Відповідь така ж проста, як і незадовільна. Не знаю точно, але гадаю, що ви не можете нічого зробити. Якщо хтось має точну інформацію з цього питання, будь ласка, дайте [» Мені](mailto:harald.radi@nme.at) знати :)

**Отже, PHP працює з COM, як щодо COM+?**

COM+ розширює COM, надаючи систему для керування компонентами через MTS та MSMQ, але тут немає нічого особливого, що PHP має підтримувати для використання таких компонентів.

**Якщо PHP може маніпулювати COM-об'єктами, чи можна уявити використання MTS для управління ресурсами компонентів у з'єднанні з PHP?**

Сам PHP ще не обробляє транзакції. Отже, якщо виникає помилка, відкат не ініціюється. Якщо ви використовуєте компоненти, що підтримують транзакції, вам необхідно буде реалізувати управління транзакціями самим.