---
navigation:
  - migration72.constants.md: « Нові глобальні константи
  - migration72.deprecated.md: 'Функціонал, оголошений застарілим у PHP 7.2.x'
  - index.md: PHP Manual
  - migration72.md: Міграція з PHP 7.1.x на PHP 7.2.x
title: 'Зміни, що ламають зворотну сумісність'
origin_hash: ddf652f5224dc9f1fa9671347921941ca401ea50
---
## Зміни, що ламають зворотну сумісність

### Предотвращение возврата отрицательного нуля из[number\_format()](function.number-format.md)

Раньше функция[number\_format()](function.number-format.md) повертала `-0`. Хоча це абсолютно правильно відповідно до специфікації чисел з плаваючою точкою IEEE 754, ця дивина небажана для відображення відформатованих чисел у формі, що легко читається.

```php
<?php

var_dump(number_format(-0.01)); // теперь выводит string(1) "0" вместо string(2) "-0"
```

### Перетворення числових ключів при приведенні об'єктів та масивів

Тепер числові ключі краще обробляються при приведенні масивів до об'єктів та об'єктів до масивів (через явне приведення, або використовуючи [settype()](function.settype.md)

Це означає, що числові (або числа у вигляді рядків) ключі з масивів, конвертовані в об'єкти, тепер будуть доступні:

```php
<?php

// приведение массива к объекту
$arr = [0 => 1];
$obj = (object)$arr;
var_dump(
    $obj,
    $obj->{'0'}, // теперь работает
    $obj->{0} // теперь работает
);
```

Результат виконання наведеного прикладу:

```
object(stdClass)#1 (1) {
  ["0"]=>    // теперь это строковый ключ, а не числовой
  int(1)
}
int(1)
int(1)
```

І тепер числові (або числа у вигляді рядків) ключі об'єктів доступні при конвертації в масиви:

```php
<?php

// приведение объекта в массив
$obj = new class {
    public function __construct()
    {
        $this->{0} = 1;
    }
};
$arr = (array)$obj;
var_dump(
    $arr,
    $arr[0], // теперь работает
    $arr['0'] // теперь работает
);
```

Результат виконання наведеного прикладу:

```
array(1) {
  [0]=>    // теперь это числовой ключ, а не строковый
  int(1)
}
int(1)
int(1)
```

### Запрещена передача\*\*`null`\*\*в[get\_class()](function.get-class.md)

Раньше передача\*\*`null`\*\* у функцію [get\_class()](function.get-class.md) повертала ім'я класу, з якого було зроблено виклик. Ця поведінка була видалена і тепер натомість буде викликана помилка рівня **`E_WARNING`**. Для досягнення тієї самої поведінки, як і раніше, слід просто опустити аргумент.

### Попередження при підрахунку нечисленних типів

Теперь при использовании[count()](function.count.md) з параметром, який не можна вважати буде виникати помилка рівня **`E_WARNING`** (це також стосується [sizeof()](function.sizeof.md) як псевдоніма цієї функції).

```php
<?php

var_dump(
    count(null), // NULL нельзя подсчитать
    count(1), // числа нельзя подсчитать
    count('abc'), // строки нельзя подсчитать
    count(new stdClass), // объекты, не реализующие интерфейс Countable, нельзя подсчитать
    count([1,2]) // массивы можно подсчитать
);
```

Результат виконання наведеного прикладу:

```
Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d
int(0)
int(1)
int(1)
int(1)
int(2)
```

### Перехід від ресурсів до об'єктів у модулі Hash

В рамках довгострокової міграції відмови від ресурсів, модуль [Hash](book.hash.md) було оновлено для використання об'єктів замість ресурсів. Ця зміна повинна бути плавною для PHP-розробників, за винятком випадків, коли використовуються перевірки [is\_resource()](function.is-resource.md) (які потрібно замінити на використання [is\_object()](function.is-object.md)

### Покращено значення за замовчуванням у SSL/TLS

Були зроблені такі зміни до значень за замовчуванням:

-   `tls://`тепер за умовчанням використовується TLSv1.0 чи TLSv1.1 чи TLSv1.2
-   `ssl://`псевдонім`tls://`
-   Константи `STREAM_CRYPTO_METHOD_TLS_*`за умовчанням рівні TLSv1.0 або TLSv1.1 + TLSv1.2 замість TLSv1.0

### Возвращаемое значение[gettype()](function.gettype.md) для закритих ресурсів

Раньше использование[gettype()](function.gettype.md) на закритому ресурсі повертало рядок `"unknown type"`. Тепер буде повернуто рядок `"resource (closed)"`

### [is\_object()](function.is-object.md)и**\_\_PHP\_Incomplete\_Class**

Раньше использование[is\_object()](function.is-object.md)на классе**\_\_PHP\_Incomplete\_Class** повертало **`false`**. Тепер повертатиметься **`true`**

### Підвищено рівні помилок невизначених констант

Не повністю визначені посилання на невизначені константи тепер генеруватимуть **`E_WARNING`** (замість **`E_NOTICE`**). У наступній основній версії PHP вони генеруватимуть винятки [Error](class.error.md)

### Підтримка Windows

Офіційно підтримувані мінімальні версії Windows тепер є Windows 7/Server 2008 R2.

### Перевірка значень властивостей за промовчанням трейту

Перевірка сумісності значень властивостей за промовчанням трейту більше не виконує приведення типу.

### `object` для імен класів

Имя`object` раніше було м'яко зарезервовано з PHP 7.0. Тепер воно повноцінне зарезервоване слово, що забороняє використовувати його як ім'я класу, трейту або інтерфейсу.

### Підтримка NetWare

Підтримка NetWare було видалено.

### [array\_unique()](function.array-unique.md)with\*\*`SORT_STRING`\*\*

Якщо `sort_flags`равен\*\*`SORT_STRING`\*\*, ранее массив`array` копіювався, а не унікальні елементи видалялися (зберігаючи значення цифрових індексів), але тепер створюється новий масив шляхом додавання унікальних елементів. Це може призвести до різних числових індексів.

### Изменения[bcmod()](function.bcmod.md) з числами з плаваючою точкою

Функция[bcmod()](function.bcmod.md) більше не обрізає числа з плаваючою точкою до цілих. Таким чином, її поведінка тепер відповідає [fmod()](function.fmod.md), а не оператору`%`Например,`bcmod('4', '3.5')` тепер повертає `0.5` замість

### Функції хешування та некриптографічні хеші

Функції [hash\_hmac()](function.hash-hmac.md) [hash\_hmac\_file()](function.hash-hmac-file.md) [hash\_pbkdf2()](function.hash-pbkdf2.md) і [hash\_init()](function.hash-init.md)(с\*\*`HASH_HMAC`\*\*) більше не приймають некриптографічні хеші.

### Опції функції [json\_decode()](function.json-decode.md)

Опція функції [json\_decode()](function.json-decode.md) **`JSON_OBJECT_AS_ARRAY`**, тепер використовується, якщо другий параметр (assoc) дорівнює **`null`**Ранее**`JSON_OBJECT_AS_ARRAY`** завжди ігнорувався.

### Висновок [rand()](function.rand.md) і [mt\_rand()](function.mt-rand.md)

Числа, що генеруються [rand()](function.rand.md) і [mt\_rand()](function.mt-rand.md) для певного параметра переініціалізації (seed) можуть відрізнятися від PHP 7.1 на 64-бітних машинах (через виправлення помилки модульного зміщення в реалізації).

### Удаление ini-настройки[`sql.safe_mode`](ini.core.md#ini.sql.safe-mode)

Налаштування конфігурації `sql.safe_mode` було видалено.

### Изменения в[date\_parse()](function.date-parse.md) і [date\_parse\_from\_format()](function.date-parse-from-format.md)

Елемент масиву `zone`, що повертається функціями [date\_parse\_from\_format()](function.date-parse-from-format.md) і [date\_parse()](function.date-parse.md) тепер відображає секунди замість хвилин, а його знак інвертується. Наприклад, `-120` тепер буде `7200`

### Вхідні Cookies

Починаючи з PHP 7.2.34 *імена* вхідні cookie більше не декодуються з URL-закодованого рядка з міркувань безпеки.
