---
navigation:
  - features.file-upload.html: « Загрузка файлов на сервер
  - features.file-upload.errors.html: Пояснення повідомлень про помилки »
  - index.md: PHP Manual
  - features.file-upload.html: Загрузка файлов на сервер
title: Завантаження файлів методом POST
---
## Завантаження файлів методом POST

Ця можливість дозволяє завантажувати як текстові, так і бінарні файли. За допомогою PHP-функцій автентифікації та роботи з файлами ви маєте повний контроль над тим, кому дозволено завантажувати файли та що робити з файлом після завантаження.

PHP здатний отримувати завантажені файли будь-якого браузера, сумісного зі стандартом RFC-1867.

> **Зауваження** **Суміжні зауваження щодо конфігурації**
> 
> Також ознайомтеся з описом директив [fileuploads](ini.core.html#ini.file-uploads) [uploadmaxfilesize](ini.core.html#ini.upload-max-filesize) [uploadtmpdir](ini.core.html#ini.upload-tmp-dir) [postmaxsize](ini.core.html#ini.post-max-size) і [maxinputtime](info.configuration.html#ini.max-input-time) конфігураційного файлу php.ini

Також слід зауважити, що PHP підтримує завантаження файлів методом PUT, який використовується у клієнтах Netscape Composer та W3C Amaya. Для отримання більш детальної документації зверніться до розділу [поддержка метода PUT](features.file-upload.put-method.md)

**Приклад #1 Форма для завантаження файлів**

Сторінка для завантаження файлів може бути реалізована за допомогою спеціальної форми, яка виглядає приблизно так:

Надіслати цей файл:

У наведеному вище прикладі `__URL__` необхідно замінити посиланням на PHP-скрипт.

Приховане поле `MAX_FILE_SIZE` (значення необхідно вказувати в байтах) має передувати полю для вибору файлу, і його значення є максимально допустимим розміром файлу, що приймається в PHP. Рекомендується завжди використовувати цю змінну, оскільки вона запобігає тривожному очікуванню користувачів при передачі величезних файлів, тільки для того, щоб дізнатися, що файл занадто великий і передача фактично не відбулася. Майте на увазі, що обійти це обмеження на стороні браузера досить просто, тому ви не повинні покладатися на те, що всі файли більшого розміру будуть блоковані за допомогою цієї можливості. Це здебільшого зручна можливість для користувачів клієнтської частини вашої програми. Однак налаштування PHP (на сервері) щодо максимального розміру оминути неможливо.

> **Зауваження**
> 
> Також слід переконатись, що форма завантаження має атрибут. `enctype="multipart/form-data"`, інакше завантаження файлів на сервер не відбудеться.

Глобальний масив [FILES](reserved.variables.files.md) містить всю інформацію про завантажені файли. Його вміст для нашого прикладу наведено нижче. Зверніть увагу, що тут передбачається використання імені *userfile* для поля вибору файлу, як і у наведеному вище прикладі. Насправді ім'я поля може бути будь-яким.

[FILES\['userfile'\]\['name'\]](reserved.variables.files.md)

Оригінальна назва файлу на комп'ютері клієнта.

[FILES\['userfile'\]\['type'\]](reserved.variables.files.md)

Mime-тип файлу, якщо браузер надав таку інформацію. Як приклад можна навести `"image/gif"`. Цей mime-тип не перевіряється на стороні PHP, тому не покладайтеся на його значення без перевірки.

[FILES\['userfile'\]\['size'\]](reserved.variables.files.md)

Розмір у байтах прийнятого файлу.

[FILES\['userfile'\]\['tmpname'\]](reserved.variables.files.md)

Тимчасове ім'я, з яким файл було збережено на сервері.

[FILES\['userfile'\]\['error'\]](reserved.variables.files.md)

[Код ошибки](features.file-upload.errors.md), яка може виникнути під час завантаження файлу.

[FILES\['userfile'\]\['fullpath'\]](reserved.variables.files.md)

Повний шлях представлений браузером. Це значення не завжди містить реальну структуру каталогів, і йому не можна довіряти. Доступно з PHP 8.1.0.

За промовчанням прийняті файли зберігаються на сервері в стандартній тимчасовій папці доти, доки не буде задана інша директорія за допомогою директиви [uploadtmpdir](ini.core.html#ini.upload-tmp-dir) конфігураційний файл php.ini. Директорію сервера за промовчанням можна змінити, встановивши змінну TMPDIR для оточення, в якому виконується PHP. Встановлення цієї змінної за допомогою функції [putenv()](function.putenv.md) всередині PHP-скрипту не працюватиме. Ця змінна оточення також може бути використана для того, щоб переконатися, що інші операції також працюють з прийнятими файлами.

**Приклад #2 Перевірка файлів, що завантажуються на сервер**

Для отримання більш детальної інформації ви можете ознайомитись з описом функцій [ісuploadedfile()](function.is-uploaded-file.html) і [moveuploadedfile()](function.move-uploaded-file.md). Наступний приклад приймає та обробляє завантажений за допомогою форми файл.

```php
<?php
$uploaddir = '/var/www/uploads/';
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

echo '<pre>';
if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
    echo "Файл корректен и был успешно загружен.\n";
} else {
    echo "Возможная атака с помощью файловой загрузки!\n";
}

echo 'Некоторая отладочная информация:';
print_r($_FILES);

print "</pre>";

?>
```

PHP-скрипт, який приймає завантажений файл, повинен реалізовувати логіку, необхідну визначення подальших дій над прийнятим файлом. Наприклад, ви можете перевірити змінну [FILES\['userfile'\]\['size'\]](reserved.variables.files.md), щоб відсікти занадто великі або занадто маленькі файли. Також ви можете використовувати змінну [FILES\['userfile'\]\['type'\]](reserved.variables.files.md) для виключення файлів, які не задовольняють критерію щодо типу файлу, однак, беріть до уваги, що це поле повністю контролюється клієнтом, використовуйте його лише як першу серію перевірок. Також ви можете використовувати [FILES\['userfile'\]\['error'\]](reserved.variables.files.md) і [коди помилок](features.file-upload.errors.md) під час реалізації вашої логіки. Незалежно від того, яку модель поведінки ви вибрали, потрібно видалити файл з тимчасової папки або перемістити його в іншу директорію.

У випадку, якщо під час відправки форми файл обраний не був, PHP встановить змінну [FILES\['userfile'\]\['size'\]](reserved.variables.files.md) значенням 0, а змінну [FILES\['userfile'\]\['tmpname'\]](reserved.variables.files.md) - none.

Після завершення роботи скрипта, якщо завантажений файл не був перейменований або переміщений, він буде автоматично видалено з тимчасової папки.

**Приклад #3 Завантаження масиву файлів**

PHP підтримує [можливість передачі масиву з HTML](faq.html.html#faq.html.arrays) у тому числі і з файлами.

Зображення:

```php
<?php
foreach ($_FILES["pictures"]["error"] as $key => $error) {
    if ($error == UPLOAD_ERR_OK) {
        $tmp_name = $_FILES["pictures"]["tmp_name"][$key];
        // basename() может спасти от атак на файловую систему;
        // может понадобиться дополнительная проверка/очистка имени файла
        $name = basename($_FILES["pictures"]["name"][$key]);
        move_uploaded_file($tmp_name, "data/$name");
    }
}
?>
```

Смуга прогресу завантаження файлів може бути реалізована за допомогою "[отслеживания прогресса загрузки файлов с помощью сессий](session.upload-progress.md)".
