---
navigation:
  - function.dio-close.md: « dio\_close
  - function.dio-open.md: dio\_open »
  - index.md: PHP Manual
  - ref.dio.md: Функції прямого введення/виводу
title: dio\_fcntl
origin_hash: ddf652f5224dc9f1fa9671347921941ca401ea50
---
# dio\_fcntl

(PHP 4 >= 4.2.0, PHP 5 < 5.1.0)

dio\_fcntl — Викликає функцію бібліотеки C fcntl для файлового дескриптора

### Опис

```methodsynopsis
dio_fcntl(resource $fd, int $cmd, mixed $args = ?): mixed
```

Функция**dio\_fcntl()** викликає вказану в `cmd`команду для`fd`. Якщо команда вимагає додаткових аргументів, вони задаються в `args`

### Список параметрів

`fd`

Файловий дескриптор, отриманий з [dio\_open()](function.dio-open.md)

`cmd`

Можливо однією з наступних операцій:

-   \*\*`F_SETLK`\*\*- Встановлення або скидання блокування. Якщо блокування будь-ким утримується,\*\*dio\_fcntl()\*\*поверне -1.
    
-   **`F_SETLKW`**\- схожа на**`F_SETLK`**, але якщо блокування будь-ким утримується,\*\*dio\_fcntl()\*\*чекатиме її звільнення.
    
-   **`F_GETLK`** **dio\_fcntl()** поверне асоціативний масив (як описано нижче) якщо хтось заважає отримати блокування. Якщо ніхто не заважає, то ключ "type" міститиме **`F_UNLCK`**
    
-   \*\*`F_DUPFD`\*\*- шукає найменший доступний файловий дескриптор, більший чи рівний`args` і повертає його.
    
-   **`F_SETFL`**\- встановлює файловий дескриптор прапори, задані в`args`, такі як**`O_APPEND`** **`O_NONBLOCK`** або **`O_ASYNC`**. Для використання\*\*`O_ASYNC`\*\*вам необхідно скористатися модулем[PCNTL](ref.pcntl.md)
    

`args`

`args` - це асоціативний масив, якщо `cmd`установлен в\*\*`F_SETLK`** або **`F_SETLLW`\*\*, з такими ключами:

-   `start`\- зміщення початку блокування
    
-   `length`\- Розмір заблокованої зони. 0 означає кінець файлу
    
-   `whence`\- Залежить від l\_start: можливо\*\*`SEEK_SET`\*\* **`SEEK_END`** і **`SEEK_CUR`**
    
-   `type`\- тип блокування: можливо\*\*`F_RDLCK`**(читання),**`F_WRLCK`**(запис) або**`F_UNLCK`\*\*(Блокування немає)
    

### Значення, що повертаються

Повертає результат виклику C-функції.

### Приклади

**Приклад #1 Встановлення та зняття блокування**

```php
<?php

$fd = dio_open('/dev/ttyS0', O_RDWR);

if (dio_fcntl($fd, F_SETLK, Array("type"=>F_WRLCK)) == -1) {
   // дескриптор файла заблокирован
   echo "Нельзя снять блокировку, она удерживается другим процессом.";
} else {
   echo "Блокировка успешно установлена/снята";
}

dio_close($fd);
?>
```

### Примітки

> **Зауваження**: Для Windows-платформ ця функція не реалізована.
