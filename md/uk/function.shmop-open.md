---
navigation:
  - function.shmop-delete.md: « shmop\_delete
  - function.shmop-read.md: shmop\_read »
  - index.md: PHP Manual
  - ref.shmop.md: 'Пам''ять, що розділяється (shared)'
title: shmop\_open
origin_hash: ddf652f5224dc9f1fa9671347921941ca401ea50
---
# shmop\_open

(PHP 4 >= 4.0.4, PHP 5, PHP 7, PHP 8)

shmop\_open — Резервування або використання блоку пам'яті, що розділяється.

### Опис

```methodsynopsis
shmop_open(    int $key,    string $mode,    int $permissions,    int $size): Shmop|false
```

**shmop\_open()** резервує або використовує існуючий блок пам'яті, що розділяється.

### Список параметрів

`key`

Системний ідентифікатор блоку пам'яті, що розділяється. Може бути заданий у десятковому або шістнадцятковому кодуванні.

`mode`

Доступні для використання прапори:

-   "a" для доступу (встановлює прапор SHM\_RDONLY) Слід застосовувати цей прапор, коли необхідно використовувати раніше зарезервовану ділянку пам'яті, що розділяється, вже містить будь-які дані. У цьому випадку доступ можливий лише для читання.
-   "c" для резервування (встановлює прапор IPC\_CREATE) Слід використовувати цей прапор для створення нової зарезервованої ділянки пам'яті, що розділяється. Якщо ділянку пам'яті з таким ідентифікатором вже існує, спроба доступу до неї виконується для подальших операцій читання та запису.
-   "w" для виконання операцій читання та запису Слід використовувати цей прапор для читання та запису даних, що зберігаються в пам'яті, що розділяється. Цей прапор використовується в більшості випадків.
-   "n" для створення у пам'яті нового сегмента (встановлює прапор IPC\_CREATE|IPC\_EXCL) Слід використовувати цей прапор для створення нового сегмента в пам'яті, що розділяється, але якщо сегмент вже існує з тим же прапором, відбувається відмова. Це корисно з метою безпеки, т.к. дозволяє уникнути помилок синхронізації (Race condition exploits).

`permissions`

Права доступу до ділянки пам'яті такі ж, як і до звичайного файлу. Їх можна вказувати у вісімковому вигляді, наприклад `0644`

`size`

Розмір резервованого блоку в пам'яті, що розділяється в байтах

> **Зауваження** :
> 
> Зверніть увагу: треті та четверті параметри повинні бути вказані як 0, якщо необхідно отримати доступ до існуючої ділянки пам'яті.

### Значення, що повертаються

У разі успішного виконання **shmop\_open()** повертає екземпляр [Shmop](class.shmop.md), який може бути використаний для доступу до зарезервованої ділянці пам'яті. У разі виникнення помилки повертає **`false`**

### Помилки

Якщо параметр `mode` вказано некоректно або параметр `size` менше або дорівнює нулю, видається помилка [ValueError](class.valueerror.md). У разі виникнення інших помилок видається помилка рівня **`E_WARNING`**

### список змін

| Версия | Опис |
| --- | --- |
| 8.0.0 | У разі успішного виконання повертається екземпляр [Shmop](class.shmop.md); раніше повертався ресурс (resource). |
| 8.0.0 | Якщо параметр `mode` вказано некоректно або параметр `size` менше або дорівнює нулю, видається помилка [ValueError](class.valueerror.md). previously **`E_WARNING`** was emitted instead, раніше натомість видавалася помилка рівня **`E_WARNING`** та функція повертала **`false`** |

### Приклади

**Приклад #1 Резервування ділянки пам'яті, що розділяється**

```php
<?php
$shm_key = ftok(__FILE__, 't');
$shm_id = shmop_open($shm_key, "c", 0644, 100);
?>
```

У наведеному прикладі виконується доступ до блоку з ідентифікатором, що повертається функцією [ftok()](function.ftok.md)

### Дивіться також

-   [shmop\_close()](function.shmop-close.md) \- Закриття блоку пам'яті, що розділяється
-   [shmop\_delete()](function.shmop-delete.md) \- Видалення блоку пам'яті, що розділяється
