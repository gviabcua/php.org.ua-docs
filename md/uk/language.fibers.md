Fibers

-   [« Наследование исключений](language.exceptions.extending.html)
    
-   [Генераторы »](language.generators.html)
    
-   [PHP Manual](index.html)
    
-   [Справочник языка](langref.html)
    
-   Fibers
    

# Fibers

### Огляд файберів

(PHP 8> = 8.1.0)

Файбери є перериваються функції повного циклу. Файбери можуть бути припинені з будь-якого місця циклу, призупиняючи виконання у файбері доти, доки файбер не буде відновлено в майбутньому.

Файбери призупиняють весь цикл виконання, тому функцію, що викликає, безпосередньо не потрібно змінювати спосіб її виклику.

Виконання може бути перервано у будь-якому місці циклу за допомогою методу [Fiber::suspend()](fiber.suspend.html) (тобто виклик [Fiber::suspend()](fiber.suspend.html) може перебувати у глибоко вкладеної функції або навіть взагалі не існувати).

На відміну від генераторів ([Generator](class.generator.html)) без стека, у кожного об'єкта [Fiber](class.fiber.html) є свій власний стек викликів, що дозволяє призупиняти їх усередині глибоко вкладених функцій викликів. Функція, яка оголошує точку переривання (тобто виклик методу [Fiber::suspend()](fiber.suspend.html)), не повинна змінювати свій тип, що повертається, на відміну від функції, що використовує [yield](language.generators.syntax.html#control-structures.yield), який має повертати екземпляр [Generator](class.generator.html)

Файбери можуть бути призупинені під час виклику будь-якої функції, включаючи ті, що викликаються з віртуальної машини PHP, наприклад, функції, що надаються [arraymap()](function.array-map.html), або методи, викликані foreach для об'єкта [Iterator](class.iterator.html)

Після припинення виконання файбера може бути відновлено з будь-яким значенням за допомогою методу [Fiber::resume()](fiber.resume.html) або шляхом передачі виключення у файбер за допомогою [Fiber::throw()](fiber.throw.html). Значення повертається (або викидається виняток) із методу [Fiber::suspend()](fiber.suspend.html)

> **Зауваження**: Через поточні обмеження неможливо перемикати файбер у деструкторі об'єкта.

**Приклад #1 Простий приклад**

```php
<?php
$fiber = new Fiber(function (): void {
   $value = Fiber::suspend('fiber');
   echo "Значение возобновлённого файбера: ", $value, PHP_EOL;
});

$value = $fiber->start();

echo "Значение приостановленного файбера: ", $value, PHP_EOL;

$fiber->resume('test');
?>
```

Результат виконання цього прикладу:

```
Значение приостановленного файбера: fiber
Значение возобновлённого файбера: test
```