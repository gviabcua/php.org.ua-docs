---
navigation:
  - security.filesystem.md: « Безпека файлової системи
  - security.database.md: Безпека баз даних »
  - index.md: PHP Manual
  - security.filesystem.md: Безпека файлової системи
title: 'Проблеми безпеки, пов''язані з нульовим байтом'
---
## Проблеми безпеки, пов'язані з нульовим байтом

Так як для роботи з файловою системою PHP використовує C-функції, то в цьому випадку можлива вкрай несподівана обробка нульового байта. Так як нульовий байт означає кінець рядка C, то рядки, що містять такий байт, не будуть трактуватися повністю, а тільки до тієї позиції, в якій знаходиться цей байт. Наступний приклад містить вразливий код, який демонструє цю проблему:

**Приклад #1 Скрипт, вразливий до нульового байта**

```php
<?php
$file = $_GET['file']; // "../../etc/passwd\0"
if (file_exists('/home/wwwrun/'.$file.'.php')) {
    // file_exists возвратит true, т.к. /home/wwwrun/../../etc/passwd существует
    include '/home/wwwrun/'.$file.'.php';
    // будет подключён файл /etc/passwd
}
?>
```

Таким чином, будь-який зіпсований рядок, що використовується в операціях з файловою системою, повинен бути відповідним чином перевірений. Ось покращена версія попереднього прикладу:

**Приклад #2 Коректна перевірка вхідних даних**

```php
<?php
$file = $_GET['file'];

// Белый список возможных значений
switch ($file) {
    case 'main':
    case 'foo':
    case 'bar':
        include '/home/wwwrun/include/'.$file.'.php';
        break;
    default:
        include '/home/wwwrun/include/main.php';
}
?>
```
