---
navigation:
  - function.dns-get-mx.html: « dnsgetмкс
  - function.fsockopen.html: fsockopen »
  - index.html: PHP Manual
  - ref.network.html: Мережеві функції
title: dnsgetrecord
---
# dnsgetrecord

(PHP 5, PHP 7, PHP 8)

dnsgetrecord — Отримання ресурсних записів DNS хоста

### Опис

```methodsynopsis
dns_get_record(    string $hostname,    int $type = DNS_ANY,    array &$authoritative_name_servers = null,    array &$additional_records = null,    bool $raw = false): array|false
```

Здійснює вибірку DNS-записів, що відповідають властивостям хоста `hostname`

### Список параметрів

`hostname`

Параметр `hostname` має бути коректним DNS-іменем таким як "`www.example.com`". Зворотний дозвіл імен хостів може бути зроблений з використанням нотації `in-addr.arpa`, однак, для цієї мети краще скористатися функцією [gethostbyaddr()](function.gethostbyaddr.html)

> **Зауваження**
> 
> Відповідно до стандартів DNS, адреси електронної пошти задаються у форматі `user.host` (наприклад, `hostmaster.example.com` на відміну від `hostmaster@example.com`), тому будьте уважні та додатково перевірте це значення, перш ніж використовувати його в таких функціях, як [mail()](function.mail.html)

`type`

За замовчуванням **dnsgetrecord()** шукатиме всі можливі записи, що відповідають заданому імені хоста `hostname`. Щоб звузити коло пошуку, можна встановити необов'язковий параметр `type`. Цей параметр може приймати такі значення: **`DNS_A`** **`DNS_CNAME`** **`DNS_HINFO`** **`DNS_CAA`** **`DNS_MX`** **`DNS_NS`** **`DNS_PTR`** **`DNS_SOA`** **`DNS_TXT`** **`DNS_AAAA`** **`DNS_SRV`** **`DNS_NAPTR`** **`DNS_A6`** **`DNS_ALL`** або **`DNS_ANY`**

> **Зауваження**
> 
> Через неоднозначну поведінку libresolv на різних платформах, **`DNS_ANY`** може повернути не всі записи, повільніший **`DNS_ALL`** поверне всі записи надійніше.

> **Зауваження**
> 
> Windows: **`DNS_CAA`** не підтримується. Підтримка **`DNS_A6`** не реалізовано.

`authoritative_name_servers`

Передається за посиланням і, якщо передано, буде заповнюватися ресурсними записами для *серверів, що засвідчують* (Authoritative Name Servers).

`additional_records`

Передається за посиланням і, якщо передано, заповнюватиметься *додатковими записами* (Additional Records).

`raw`

`type` буде інтерпретований як необроблений ідентифікатор типу DNS (не можна використовувати константи `DNS_*`). Значення, що повертається, міститиме ключ `data`, що необхідно проаналізувати вручну.

### Значення, що повертаються

Ця функція повертає масив асоціативних масивів або **`false`** у разі виникнення помилки. Кожен асоціативний масив містить *щонайменше* такі ключі:

**Основні атрибути DNS**

| Атрибут | Описание |
| --- | --- |
| host | Запис у просторі імен DNS, на яку посилається решта даних. |
| class | **dnsgetrecord()** повертає тільки записи класу Internet, відповідно цей параметр завжди прийматиме значення `IN` |
| type | Рядок, що містить тип запису. Додаткові атрибути також містяться в результуючому масиві в залежності від типу. По одному вкладеному масиву за кожен тип. Дивіться таблицю нижче. |
| ttl | Час життя (`"Time To Live"`) Залишилося для цього запису. Це *не* вихідне ttl записи. Воно дорівнює вихідному за вирахуванням часу, що минув з моменту відправки запиту на сервер. |

**Інші ключі асоціативного масиву, що відповідають типу 'type'**

| Тип записи | Дополнительные данные |
| --- | --- |
| `A` | `ip`: адреси IPv4 у десятковому форматі з роздільниками. |
| `MX` | `pri`: Пріоритет поштового сервера Чим нижче число, тим вищий пріоритет . `target`: FQDN поштового сервера Дивіться також [dnsgetmx()](function.dns-get-mx.html) |
| `CNAME` | `target`: FQDN розташування в просторі імен DNS, на яке вказує запис. |
| `NS` | `target`: FQDN - ім'я сервера, який є авторитетним для цього імені хоста. |
| `PTR` | `target`: Розміщення без вказівки простору імен DNS, на яке вказує запис. |
| `TXT` | `txt`: Рядок даних, пов'язаних із цим записом. |
| `HINFO` | `cpu`: число IANA, що позначає модель процесора комп'ютера, який вказує цей запис . `os`: число IANA, що означає операційну систему комп'ютера, який вказує цей запис. Дивіться додатково IANA [`Operating System Names`](http://www.iana.org/assignments/operating-system-names) |
| `CAA` | `flags`: Однобайтове бітове поле; в даний момент визначено лише біт номер 0, що називається 'critical'; інші біти зарезервовані та повинні ігноруватися . `tag`: Ім'я тега CAA (літерно-числовий рядок ASCII) . `value`: Значення CAA (бінарний рядок, можна використовувати підформати). Докладніше читайте тут: [» RFC 6844](http://www.faqs.org/rfcs/rfc6844) |
| `SOA` | `mname`: FQDN початкового комп'ютера, з якого отримано ресурсні записи . `rname`: Адреса електронної пошти адміністратора домену . `serial`: Порядковий номер цієї ревізії домена . `refresh`: Інтервал часу (в секундах), який повинні використовувати вторинні сервери при оновленні видалених копій цього домену . `retry`: Час очікування (у секундах) після невдалого оновлення до наступної спроби . `expire`: Максимальний час (в секундах), протягом якого вторинний DNS-сервер повинен тримати в пам'яті дані віддалених копій доменної зони, перш ніж відповісти відмовою, коли не вдається оновити дані . `minimum-ttl`: Мінімальний час (у секундах), протягом якого клієнт може працювати з поточною DNS-роздільною здатністю, перш ніж йому доведеться повторно запитувати цю роздільну здатність. Значення може бути замінено окремими ресурсними записами. |
| `AAAA` | `ipv6`: адреса IPv6 |
| `A6` | `masklen`: Довжина (у бітах), яку потрібно успадкувати від цільової адреси `chain`. . `ipv6`: Адреса для цього конкретного запису, який потрібно об'єднати з `chain`. . `chain`: Запис, який потрібно доповнити даними `ipv6` |
| `SRV` | `pri`: (Пріоритет) менші значення повинні використовуватися першими . `weight`: Ранжування. Записам з великою вагою віддається перевага . `targets` повинен вибиратися випадково . `target` і `port`: ім'я хоста та номер порту, на якому можна знайти потрібну службу. Додаткову інформацію можна отримати за посиланням: [» RFC 2782](http://www.faqs.org/rfcs/rfc2782) |
| `NAPTR` | `order` і `pref`: Еквівалентні `pri` і `weight` наведеним вище . `flags` `services` `regex` і `replacement`: Параметри, визначені в [» RFC 2915](http://www.faqs.org/rfcs/rfc2915) |

### список змін

| Версия | Описание |
| --- | --- |
|  | Додано підтримку записів типу CAA. |

### Приклади

**Приклад #1 Приклад використання **dnsgetrecord()****

```php
<?php
$result = dns_get_record("php.net");
print_r($result);
?>
```

Результатом виконання цього прикладу буде щось подібне:

```
Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => MX
            [pri] => 5
            [target] => pair2.php.net
            [class] => IN
            [ttl] => 6765
        )

    [1] => Array
        (
            [host] => php.net
            [type] => A
            [ip] => 64.246.30.37
            [class] => IN
            [ttl] => 8125
        )

)
```

**Приклад #2 Використання **dnsgetrecord()** з DNSANY**

Так як досить часто потрібно визначити IP-адресу поштового сервера, після того як запис MX було дозволено, **dnsgetrecord()** повертає масив `additional_records` із відповідними записами. Масив `authoritative_name_servers` міститиме список посвідчувальних DNS-серверів.

```php
<?php
/* Отправим "ANY" запрос к php.net,
   создадим Масиви $authns и $addtl,
   в которые будут помещён список серверов
   имён и дополнительные записи,
   соответствующие этим серверам
*/
$result = dns_get_record("php.net", DNS_ANY, $authns, $addtl);
echo "Результат = ";
print_r($result);
echo "Удостоверяющие серверы = ";
print_r($authns);
echo "Дополнительные записи = ";
print_r($addtl);
?>
```

Результатом виконання цього прикладу буде щось подібне:

```
Результат = Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => MX
            [pri] => 5
            [target] => pair2.php.net
            [class] => IN
            [ttl] => 6765
        )

    [1] => Array
        (
            [host] => php.net
            [type] => A
            [ip] => 64.246.30.37
            [class] => IN
            [ttl] => 8125
        )

)
Удостоверяющие серверы = Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => remote1.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [1] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => remote2.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [2] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => ns1.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [3] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => ns2.easydns.com
            [class] => IN
            [ttl] => 10722
        )

)
Дополнительные записи = Array
(
    [0] => Array
        (
            [host] => pair2.php.net
            [type] => A
            [ip] => 216.92.131.5
            [class] => IN
            [ttl] => 6766
        )

    [1] => Array
        (
            [host] => remote1.easydns.com
            [type] => A
            [ip] => 64.39.29.212
            [class] => IN
            [ttl] => 100384
        )

    [2] => Array
        (
            [host] => remote2.easydns.com
            [type] => A
            [ip] => 212.100.224.80
            [class] => IN
            [ttl] => 81241
        )

    [3] => Array
        (
            [host] => ns1.easydns.com
            [type] => A
            [ip] => 216.220.40.243
            [class] => IN
            [ttl] => 81241
        )

    [4] => Array
        (
            [host] => ns2.easydns.com
            [type] => A
            [ip] => 216.220.40.244
            [class] => IN
            [ttl] => 81241
        )

)
```

### Дивіться також

-   [dnsgetmx()](function.dns-get-mx.html) - Псевдонім getmxrr
-   [dnscheckrecord()](function.dns-check-record.html) - Псевдонім checkdnsrr
