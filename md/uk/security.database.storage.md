---
navigation:
  - security.database.connection.md: « З'єднання з базою даних
  - security.database.sql-injection.md: SQL-ін'єкції »
  - index.md: PHP Manual
  - security.database.md: Безпека баз даних
title: Шифрування сховища бази даних
---
## Шифрування сховища бази даних

Ви можете встановити з'єднання через SSL для шифрування зв'язку клієнт/сервер для підвищення безпеки, або ви можете використовувати ssh для шифрування з'єднання між клієнтами і сервером бази даних. Якщо будь-який з них використовується, моніторинг вашого трафіку та отримання інформації про вашу базу даних буде важким для потенційного зловмисника.

У випадку, якщо зломщик отримав безпосередній доступ до БД (в обхід веб-сервера), він може отримати дані, що цікавлять, або порушити їх цілісність, якщо інформація не захищена на рівні самої БД. Шифрування даних - хороший спосіб запобігти такій ситуації, але лише незначна кількість БД надають таку можливість.

Найбільш просте вирішення цієї проблеми - встановити спочатку звичайний програмний пакет для шифрування даних, а потім використовувати його у ваших PHPскриптів. PHP може вам допомогти з цим завданням за допомогою таких модулів як [OpenSSL](book.openssl.md) і [Sodium](book.sodium.md), що реалізують досить велику кількість алгоритмів шифрування. При такому підході скрипт спочатку шифрує дані, що зберігаються, а потім дешифрує їх при запиті. Нижче наведено приклади того, як працює шифрування даних у PHP-скриптах.

### Хешування

У разі роботи із прихованими службовими даними, якщо не потрібне їхнє нешифроване подання (тобто його не потрібно показувати), то, як наслідок, можна використовувати хешування. Добре відомий приклад хешування - зберігання криптографічного хешу від пароля БД, замість зберігання оригінального значення.

Функція [password](ref.password.md) дозволяє зручно хешувати конфіденційні дані та працювати з цими хешами.

[passwordhash()](function.password-hash.md) дозволяє хешувати заданий рядок найсильнішим з доступних алгоритмом і [passwordverify()](function.password-verify.md) перевіряє, що заданий пароль збігається зі збереженим у БД хешем.

**Приклад #1 Хешування полів із паролями**

```php
<?php

// Сохраняем хеш пароля
$query  = sprintf("INSERT INTO users(name,pwd) VALUES('%s','%s');",
            pg_escape_string($username),
            password_hash($password, PASSWORD_DEFAULT));
$result = pg_query($connection, $query);

// проверка введённого пользователем пароля на корректность
$query = sprintf("SELECT pwd FROM users WHERE name='%s';",
            pg_escape_string($username));
$row = pg_fetch_assoc(pg_query($connection, $query));

if ($row && password_verify($password, $row['pwd'])) {
    echo 'Добро пожаловать, ' . htmlspecialchars($username) . '!';
} else {
    echo 'Ошибка авторизации, ' . htmlspecialchars($username) . '.';
}

?>
```
