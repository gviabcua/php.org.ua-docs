Виконує складання сміття даних сесії

-   [« session\_encode](function.session-encode.html)
    
-   [session\_get\_cookie\_params »](function.session-get-cookie-params.html)
    
-   [PHP Manual](index.html)
    
-   [Функции для работы с сессиями](ref.session.html)
    
-   Виконує складання сміття даних сесії
    

# sessionгк

(PHP 7> = 7.1.0, PHP 8)

sessiongc — Складання сміття даних сесії

### Опис

```methodsynopsis
session_gc(): int|false
```

**sessiongc()** використовується для виконання складання сміття (garbage collection) для даних сесії. За промовчанням PHP виконує засновану на ймовірності складання сміття сесії.

Складання сміття, засноване на ймовірності в цілому працює, але має кілька проблем. 1) На низькозавантажених сайтах ці сесії можуть бути не видалені протягом бажаного часу. 2) На високозавантажених сайтах складання сміття може виконуватися надто часто. 3) Складання сміття виконується під час обробки запиту користувача, що призводить до додаткової затримки користувача.

Тому рекомендується виконувати складання сміття на робочих системах періодично, наприклад, використовувати завдання cron у UNIX-подібних системах. При цьому переконайтесь, що вимкнули складання сміття на основі ймовірності, встановивши [session.gc\_probability](session.configuration.html#ini.session.gc-probability) 0.

### Список параметрів

Ця функція не має параметрів.

### Значення, що повертаються

**sessiongc()** повертає кількість віддалених даних сесії при успішному виконанні та **`false`** у разі невдачі.

Старі обробники сесії не повертають кількість віддалених даних сесії, а лише прапор успіху/невдачі. У цьому випадку, кількість віддалених даних сесії завжди дорівнюватиме 1, незалежно від фактичної кількості видалених даних.

### Приклади

**Приклад #1 Приклад використання **sessiongc()** у диспетчерах завдань, таких як cron**

```php
<?php
// Примечание: Данный скрипт должен выполняться под тем же пользователем процесса веб-сервера.

// Нужна активная сессия для инициализации доступа к хранилищу данных сессии.
session_start();

// Принудительное выполнение сборки мусора
session_gc();

// Очистка идентификатора сессии
session_destroy();
?>
```

**Приклад #2 Приклад використання **sessiongc()** у скрипті, доступному користувачеві**

```php
<?php
// Примечание: session_gc() рекомендуется использовать через скрипт диспетчера задач,
// но можно использовать и следующим образом.

// Используется для проверки времени последней сборки мусора
$gc_time = '/tmp/php_session_last_gc';
$gc_period = 1800;

session_start();
// Выполнять сборку мусора только по истечении периода,
// поскольку вызов session_gc() при каждом запросе является пустой тратой ресурсов.
if (file_exists($gc_time)) {
    if (filemtime($gc_time) < time() - $gc_period) {
        session_gc();
        touch($gc_time);
    }
} else {
    touch($gc_time);
}
?>
```

### Дивіться також

-   [session\_start()](function.session-start.html) - Стартує нову сесію, або відновлює існуючу
-   [session\_destroy()](function.session-destroy.html) - Знищує всі дані сесії
-   [session.gc\_probability](session.configuration.html#ini.session.gc-probability)