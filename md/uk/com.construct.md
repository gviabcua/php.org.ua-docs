Конструктор класу com

-   [« com](class.com.html)
    
-   [dotnet »](class.dotnet.html)
    
-   [PHP Manual](index.html)
    
-   [com](class.com.html)
    
-   Конструктор класу com
    

# com::construct

(PHP 4> 4.1.0, PHP 5, PHP 7, PHP 8)

com::construct - Конструктор класу com

### Опис

public **com::construct**  
string `$module_name`  
array|string|null `$server_name` **`null`**  
int `$codepage` **`CP_ACP`**  
string `$typelib` = ""

Створює об'єкт класу com.

### Список параметрів

`module_name`

ProgID, Class ID або Moniker, що вказує на компонент для завантаження. Зазвичай ProgID – це ім'я програми або DLL та ім'я об'єкта, розділені точкою. Наприклад: `Word.Application`. Class ID – це UUID, унікальний для заданого класу. Moniker - спеціальна форма іменування, схожа за концепцією URL, яка ідентифікує ресурс і спосіб його завантаження. Наприклад, ви можете завантажити Word і отримати об'єкт, що представляє документ, вказавши повний шлях до документа word як ім'я модуля, або використовувати `LDAP:` як монікер для використання ADSI інтерфейсу до LDAP.

`server_name`

Ім'я сервера DCOM, на якому компонент має бути завантажений та запущений. Якщо поставлено як **`null`**, об'єкт буде запущено на сервері за промовчанням для програми. Зазвичай сервер за промовчанням – це локальний комп'ютер, якщо адміністратор не налаштував інакше. Якщо для сервера вказано значення, відмінне від **`null`**, PHP не завантажуватиме об'єкт, доки ви не встановите опцію конфігурації php.ini [com.allowdcom](com.configuration.html#ini.com.allow-dcom) в **`true`**

Якщо `server_name` заданий як масив, цей масив повинен містити такі елементи (регістр символів важливий). Зверніть увагу, що всі вони необов'язкові (єдино, що Username і Password повинні йти парою); Якщо ви не вкажете Server, то буде обрано сервер за замовчуванням і створення об'єкта не залежатиме від значення налаштування директиви php.ini [com.allowdcom](com.configuration.html#ini.com.allow-dcom)

**Ім'я сервера DCOM**

| ключ     | тип     | описание                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|----------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Server   | string  | Ім'я сервера.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Username | string  | Ім'я користувача.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Password | string  | Пароль для `Username`                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Domain   | string  | Домен для `server`                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Flags    | integer | Одна або кілька констант, об'єднаних логічним АБО: **`CLSCTX_INPROC_SERVER`** **`CLSCTX_INPROC_HANDLER`** **`CLSCTX_LOCAL_SERVER`** **`CLSCTX_REMOTE_SERVER`** **`CLSCTX_SERVER`** і **`CLSCTX_ALL`**. Значення за замовчуванням **`CLSCTX_SERVER`**, якщо `Server` не заданий і \*\*`CLSCTX_REMOTE_SERVER`\*\*якщо заданий. Про призначення цих констант можна прочитати в документації Microsoft CoCreateInstance. Але насправді вони вам навряд чи знадобляться. |

`codepage`

Кодова сторінка для перетворення на юнікод і назад. Конвертація відбувається коли рядок PHP передається як параметр COM об'єкту і коли від нього надходить відповідь. Зверніть увагу, що ця кодова сторінка буде використовуватися для всіх об'єктів та варіантів, що повертаються цим об'єктом. Допустимі значення: **`CP_ACP`** (Значення за замовчуванням. Системна кодова сторінка ANSI), **`CP_MACCP`** **`CP_OEMCP`** **`CP_SYMBOL`** **`CP_THREAD_ACP`** (Використовувати кодову сторінку/локаль, встановлену для запущеного потоку), **`CP_UTF7`** і **`CP_UTF8`**. Також можна використовувати число, яке означає кодову сторінку. Подробиці читайте у документації Microsoft.