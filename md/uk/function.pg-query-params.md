---
navigation:
  - function.pg-put-line.md: « pgputline
  - function.pg-query.md: пгquery »
  - index.md: PHP Manual
  - ref.pgsql.md: Функции PostgreSQL
title: пгqueryparams
---
# пгqueryparams

(PHP 5> = 5.1.0, PHP 7, PHP 8)

пгqueryparams — Посилає параметризований запит на сервер, параметри передаються окремо від тексту запиту SQL

### Опис

```methodsynopsis
pg_query_params(PgSql\Connection $connection = ?, string $query, array $params): PgSql\Result|false
```

Посилає параметризований запит на сервер і чекає на результат. Параметри надсилаються окремо від рядка запиту.

**пгqueryparams()** подібна до функції [пгquery()](function.pg-query.md), але надає додатковий функціонал: параметри запиту можна надсилати окремо від рядка запиту . **пгqueryparams()** підтримується на з'єднаннях із серверами PostgreSQL версій 7.4 та вище. Функція не працюватиме із серверами ранніх версій.

Якщо використовуються параметри `params`, вони замінюють псевдозмінні $1, $2 і т.д. у рядку запиту `query`. Один і той же параметр може бути вказаний більше одного разу в `query`; у цьому випадку будуть використані однакові значення . `params` визначають поточні значення параметрів. Значення **`null`** у масиві параметрів означатиме SQL `NULL` у запиті.

Головна перевага **пгqueryparams()** перед [пгquery()](function.pg-query.md) полягає в тому, що значення параметрів можуть передаватися окремо від рядка запиту `query`. Це дає можливість уникнути стомлюючу і схильну до помилок процедуру екранування спецсимволів і укладання значень у лапки. Однак, на відміну від [пгquery()](function.pg-query.md), ця функція підтримує лише один SQL запит у рядку, що передається. (Він може містити крапку з комою, але не більше однієї непустої SQL-команди.)

### Список параметрів

`connection`

Екземпляр [PgSqlConnection](class.pgsql-connection.md). Якщо `connection` не вказано, використовується стандартне з'єднання. Стандартне з'єднання - це останнє з'єднання, виконане за допомогою функцій [пгconnect()](function.pg-connect.md) або [пгpconnect()](function.pg-pconnect.md)

**Увага**

Починаючи з версії PHP 8.1.0, використання стандартного з'єднання застаріло.

`query`

Параметризований запит SQL. Повинен містити лише один вираз (кілька виразів розділених крапкою з комою не підтримуються). Якщо в запит будуть передаватися параметри, вони замінять псевдозмінні $1, $2 і т.д.

Користувацькі дані завжди повинні передаватися як параметри, і не передаватися в рядок запиту безпосередньо, де вони можуть призвести до можливих атак через [SQL-ін'єкції](security.database.sql-injection.md) і призводить до помилок, якщо дані містять лапки. Якщо з якихось причин ви не можете використовувати параметр, переконайтеся, що дані користувача [правильно екрановані](function.pg-escape-string.md)

`params`

Масив значень параметрів запиту для заміни псевдозмінних $1, $2 і т.д. у вихідному рядку запиту. Кількість елементів масиву має точно збігатися з кількістю псевдозмінних.

Значення призначені для `bytea` полів не можна передавати у параметрах. Використовуйте функцію [пгescapebytea()](function.pg-escape-bytea.md) або функції великих об'єктів.

### Значення, що повертаються

Екземпляр [PgSqlResult](class.pgsql-result.md) у разі успішного виконання або **`false`** у разі виникнення помилки.

### список змін

| Версия | Описание |
| --- | --- |
|  | Повертає екземпляр [PgSqlResult](class.pgsql-result.md); раніше повертався ресурс ([resource](language.types.resource.md) |
|  | Параметр `connection` тепер чекає екземпляр [PgSqlConnection](class.pgsql-connection.md); раніше очікувався ресурс ([resource](language.types.resource.md) |

### Приклади

**Приклад #1 Приклад використання **пгqueryparams()****

```php
<?php
// Подключение к базе данных "mary"
$dbconn = pg_connect("dbname=mary");

// Найдём все магазины с названием "Joe's Widgets". Стоит отметить, что нет необходимости экранировать
// спецсимволы в строке "Joe's Widgets"
$result = pg_query_params($dbconn, 'SELECT * FROM shops WHERE name = $1', array("Joe's Widgets"));

// Для сравнения то же самое, используя функцию pg_query
$str = pg_escape_string("Joe's Widgets");
$result = pg_query($dbconn, "SELECT * FROM shops WHERE name = '{$str}'");

?>
```

### Дивіться також

-   [пгquery()](function.pg-query.md) - Виконує запит
