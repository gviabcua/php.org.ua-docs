Налаштування під час виконання

-   [« Тестирование](oci8.test.html)
    
-   [Предопределённые константы »](oci8.constants.html)
    
-   [PHP Manual](index.html)
    
-   [Установка и настройка](oci8.setup.html)
    
-   Налаштування під час виконання
    

## Налаштування під час виконання

Поведінка цих функцій залежить від установок у php.ini.

**Параметри конфігурації OCI8**

| Имя                                                                                         | По умолчанию | Место изменения | Список изменений                                                             |
|---------------------------------------------------------------------------------------------|--------------|-----------------|------------------------------------------------------------------------------|
| [oci8.connection\_class](oci8.configuration.html#ini.oci8.connection-class)                 | ""           | PHPINIALL       | Доступна з версії PECL OCI8 1.3.                                             |
| [oci8.default\_prefetch](oci8.configuration.html#ini.oci8.default-prefetch)                 | "100"        | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |
| [oci8.events](oci8.configuration.html#ini.oci8.events)                                      | Off          | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.3.                                             |
| [oci8.max\_persistent](oci8.configuration.html#ini.oci8.max-persistent)                     | "-1"         | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1. Оголошена застарілою починаючи з PHP 8.1.0. |
| [oci8.old\_oci\_close\_semantics](oci8.configuration.html#ini.oci8.old-oci-close-semantics) | Off          | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |
| [oci8.persistent\_timeout](oci8.configuration.html#ini.oci8.persistent-timeout)             | "-1"         | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |
| [oci8.ping\_interval](oci8.configuration.html#ini.oci8.ping-interval)                       | "60"         | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |
| [oci8.prefetch\_lob\_size](oci8.configuration.html#ini.oci8.prefetch-lob-size)              | "0"          | PHPINISYSTEM    | Доступна з версії PECL OCI8 3.2.                                             |
| [oci8.privileged\_connect](oci8.configuration.html#ini.oci8.privileged-connect)             | Off          | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |
| [oci8.statement\_cache\_size](oci8.configuration.html#ini.oci8.statement-cache-size)        | "20"         | PHPINISYSTEM    | Доступна з версії PECL OCI8 1.1.                                             |

Коротке пояснення конфігураційних директив.

`oci8.connection_class` string

Цей текст, що визначається користувачем, обов'язково повинен бути заданий при використанні резидентного пулу з'єднань бази даних Oracle (Database Resident Connection Pooling (DRCP)). Це дозволяє суб-партиціонування пулу з'єднань DRCP, що дозволяє постійним з'єднанням OCI8 із програми знову використовувати сесії бази даних від попереднього PHP-скрипту, покращуючи масштабованість. Якщо програма використовує процес з пулу бази даних, який раніше використовується з іншим класом з'єднань, налаштування сесії, такі як формат дати Oracle, будуть скинуті. Це запобігає випадковому обміну інформацією між різними додатками.

Значення може бути встановлене під час виконання скрипту за допомогою [ini\_set()](function.ini-set.html) до встановлення з'єднання.

Для використання DRCP, OCI8 має бути зібрана з бібліотеками Oracle 11*г* або новіше і база даних має бути Oracle 11*г* чи новіший. Пул з'єднань DRCP у базі даних має бути включений, `oci8.connection_class` має бути встановлене в те саме рядкове значення для всіх веб-серверів, що виконують одну і ту ж програму, а рядок з'єднання OCI8 повинен вказувати на сервер з пула. Програма повинна використовувати постійні з'єднання.

`oci8.default_prefetch` int

Ця опція встановлює значення за замовчуванням для кількості екстра рядів, які будуть повернуті та автоматично закешовані за низькорівневого запиту даних з бази даних. Встановлення значення в `0` вимикає попередню вибірку (prefetching).

Значення попередньої вибірки не змінює кількість рядів, що повертаються користувачеві такими функціями як [oci\_fetch\_array()](function.oci-fetch-array.html); OCI8 внутрішньо обробляє попередню вибірку та кешування рядів.

Значення може бути встановлене окремо для кожного виразу (per-statement) за допомогою [oci\_set\_prefetch()](function.oci-set-prefetch.html) до виконання самого виразу.

У PHP 5.3 (PECL OCI8 1.3.4) значення за замовчуванням було збільшено з `10` до `100`

У PHP 5.3.2 (PECL OCI8 1.4) мінімально встановлене значення було зменшено з `1` до `0`, дозволяючи таким чином вимкнення попередньої вибірки.

При використанні Oracle Database 12*з* або нове попереднє значення, задане PHP, може бути перевизначено клієнтським конфігураційним файлом Oracle `oraaccess.xml`. Зверніться до документації Oracle.

> **Зауваження**: Велика попередня вибірка може покращити продуктивність за рахунок деякого збільшеного використання пам'яті. Для запитів, що повертають великі масиви даних, вигода у продуктивності буде значною.

`oci8.events` bool

Включення (`On`) дозволяє повідомити PHP про події Швидкого Повідомлення Додатків бази даних (FAN).

Без FAN, якщо екземпляр бази даних або вузол машини несподівано дасть збій, PHP програми можуть бути заблоковані, очікуючи на відповідь від бази даних до перевищення часу очікування TCP. За допомогою подій FAN PHP програми швидко будуть повідомлені про збої, які впливають на встановлені ними з'єднання до бази даних. Модуль OCI8 підчистить з'єднання, що не використовуються, в кеші постійних з'єднань.

При використанні директиви (`On`), база даних також має бути налаштована на відправку FAN подій.

Підтримка FAN доступна, якщо OCI8 була злінкована з бібліотеками Oracle 10*г*R2 (або пізнішими) та з'єднання було здійснено до Oracle Database 10*г*R2 (або пізнішої версії).

`oci8.max_persistent` int

Максимальна кількість постійних з'єднань OCI8 на один процес PHP. Встановлення цієї опції -1 означає відсутність ліміту.

`oci8.old_oci_close_semantics` bool

Ця опція контролює поведінку функції [oci\_close()](function.oci-close.html). Її включення означає, що [oci\_close()](function.oci-close.html) не робить нічого; з'єднання не буде закрито, доки не закінчиться виконання скрипту. Це зроблено лише з метою зворотної сумісності. Якщо ви відчуваєте потребу в цьому налаштуванні, *суворо рекомендується* налаштувати виклики [oci\_close()](function.oci-close.html) у ваших скриптах замість увімкнення цієї опції.

`oci8.persistent_timeout` int

Максимальна кількість секунд, що дозволяється PHP-процесу тримати постійне з'єднання відкритим, що не використовується. Встановлення цієї опції в -1 означає, що з'єднання, що не використовуються, будуть утримані, поки PHP-процес не завершить своє виконання або з'єднання не буде примусово закрито за допомогою функції [oci\_close()](function.oci-close.html)

> **Зауваження**: У PHP закінчення терміну дії ресурсів, що не використовуються, не засноване на повідомленнях. Воно відбувається коли PHP завершує обробку скрипта і перевіряє позначку часу останніх використаних ресурсів. Звідси виникає наступний парадокс: з'єднання, що не використовуються, можуть бути закриті тільки коли є деяка активність (хоча і не обов'язково пов'язана з OCI8) в PHP-процесі. Якщо є більше одного PHP-процесу, то кожен з них окремо повинен бути приведений в дію для того, щоб ініціювати закінчення терміну дії ресурсів, що простоюють. Введення резидентного пулу з'єднань бази даних (DRCP) у Oracle 11*г* вирішує проблеми з пам'яттю та ресурсами, які раніше намагалися вирішити `oci8.max_persistent` і `oci8.persistent_timeout`

> **Зауваження**: У PHP 5.3 (PECL OCI8 1.3), постійні з'єднання можуть бути закриті за допомогою [oci\_close()](function.oci-close.html)

`oci8.ping_interval` int

Кількість секунд, що має пройти до пінгу протягом виконання [oci\_pconnect()](function.oci-pconnect.html). Пінг забезпечує коректність з'єднання бази даних. Якщо встановлено 0, постійні з'єднання пінгуватимуться під час кожного виклику [oci\_pconnect()](function.oci-pconnect.html). Для повного відключення пінгів встановіть цю опцію -1.

> **Зауваження**: Відключення пінгів дозволяє [oci\_pconnect()](function.oci-pconnect.html) діяти з максимальною ефективністю, але PHP може бути нездатним визначити непридатні з'єднання, наприклад, при обриві мережі або при відключенні бази даних Oracle після того, як PHP встановив з'єднання, доки з'єднання знову не буде використано в скрипті. Проконсультуйтеся з документацією функції [oci\_pconnect()](function.oci-pconnect.html) для більш детальної інформації.

`oci8.prefetch_lob_size` int

Параметр налаштування, що впливає на внутрішню буферизацію даних LOB. Збільшення цього значення може покращити продуктивність вибірки менших LOB за рахунок скорочення кругових обходів між PHP та базою даних. Використання пам'яті зміниться.

Значення впливає на LOB, що повертаються як екземпляри OCILob, а також на ті, що повертаються з використанням **`OCI_RETURN_LOBS`**

Значення може бути встановлене для кожного оператора за допомогою функції [oci\_set\_prefetch\_lob()](function.oci-set-prefetch-lob.html) до виконання оператора.

> **Зауваження**: Використовуйте з Oracle Database 12.2 або новішим.

`oci8.privileged_connect` bool

Ця опція дозволяє з'єднанням використовувати привілейовані зовнішні облікові записи **`OCI_SYSOPER`** або **`OCI_SYSDBA`**

> **Зауваження**: Встановлення цієї директиви в `On` дозволить скриптам, запущеним з відповідними користувальницькими привілеями операційної системи, з'єднуватися з базою даних як привілейовані користувачі бази даних без вимоги пароля. Це може бути брехнею системи безпеки.

`oci8.statement_cache_size` int

Ця опція включає кешування виразів, а також показує скільки виразів необхідно кешувати. Для відключення кешування виразів просто встановіть значення цієї опції 0.

Кешування виразів прибирає необхідність передавати текст виразу до бази даних, а також зворотну передачу різних метаданих про це вираз назад до PHP. Це може значно покращити загальну продуктивність системи у додатках, які повторно використовують вирази протягом життя однієї сполуки. Деякі додаткові "курсори" баз даних можуть залишитися відкритими, маючи на увазі, що дані вирази будуть використані повторно.

Встановіть це значення розміром робочого набору виразів, які використовуються вашою програмою. Встановлення занадто малого значення може спричинити викид виразів з кеша до їх повторного використання.

Ця опція найчастіше використовується із постійними з'єднаннями.

При використанні Oracle Database 12*з* або вище, попереднє значення, задане PHP, може бути перевизначено клієнтським конфігураційним файлом Oracle `oraaccess.xml`. Зверніться до документації Oracle.