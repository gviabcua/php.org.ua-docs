Отримує опції потоку для сокету

-   [« socket\_export\_stream](function.socket-export-stream.html)
    
-   [socket\_getopt »](function.socket-getopt.html)
    
-   [PHP Manual](index.html)
    
-   [Функции сокета](ref.sockets.html)
    
-   Отримує опції потоку для сокету
    

# socketgetoption

(PHP 4> = 4.3.0, PHP 5, PHP 7, PHP 8)

socketgetoption — Отримує опції потоку для сокету

### Опис

```methodsynopsis
socket_get_option(Socket $socket, int $level, int $option): array|int|false
```

Функція **socketgetoption()** витягує значення для опції, вказаної параметром `option` для заданого `socket`

### Список параметрів

`socket`

Екземпляр [Socket](class.socket.html), створений за допомогою [socket\_create()](function.socket-create.html) або [socket\_accept()](function.socket-accept.html)

`level`

Параметр `level` вказує рівень протоколу, у якому перебуває опція. Наприклад, для отримання опцій на рівні сокету повинен використовувати параметр `level`, рівний **`SOL_SOCKET`**. Інші рівні, такі як **`TCP`**, можна використовувати, вказавши номер протоколу цього рівня. Номери протоколів можна знайти за допомогою функції [getprotobyname()](function.getprotobyname.html)

`option`

**Доступні опції сокету**

| Опция                                                                                                                                                                                                                                                                                                                                      | Описание                                                                                                                                                                                                                         | Тип |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----|
| **`SO_DEBUG`**                                                                                                                                                                                                                                                                                                                             | Повідомляє, чи записується налагоджувальна інформація.                                                                                                                                                                           | int |
| **`SO_BROADCAST`**                                                                                                                                                                                                                                                                                                                         | Повідомляє, чи підтримується передача широкомовних повідомлень.                                                                                                                                                                  | int |
| **`SO_REUSEADDR`**                                                                                                                                                                                                                                                                                                                         | Повідомляє, чи локальні адреси можуть використовуватися повторно.                                                                                                                                                                | int |
| **`SO_REUSEPORT`**                                                                                                                                                                                                                                                                                                                         | Повідомляє, чи локальні порти можуть використовуватися повторно.                                                                                                                                                                 | int |
| **`SO_KEEPALIVE`**                                                                                                                                                                                                                                                                                                                         | Повідомляє, чи підтримуються з'єднання з періодичною передачею повідомлень. Якщо підключений сокет не відповідає на ці повідомлення, підключення переривається і процеси запису до цього сокету повідомляються сигналом SIGPIPE. | int |
| **`SO_LINGER`**                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                  |     |
| Повідомляє, чи буде `socket` зупинятися на [socket\_close()](function.socket-close.html), якщо дані є. За умовчанням, коли сокет закритий, він спробує надіслати всі ненадіслані дані. У разі сокету, орієнтованого на підключення, [socket\_close()](function.socket-close.html) чекатиме, поки його одноранговий вузол підтвердить дані. |                                                                                                                                                                                                                                  |     |

Якщо lonoff відмінний від нуля, а llinger дорівнює нулю, всі ненадіслані дані будуть відкинуті і RST (скидання) відправлений одноранговому вузлу у разі сокету, орієнтованого на підключення.

З іншого боку, якщо lonoff та llinger відмінні від нуля, [socket\_close()](function.socket-close.html) буде блокуватися до тих пір, поки всі дані не будуть надіслані або якщо час, вказаний у llinger, не закінчиться. Якщо сокет не блокується, [socket\_close()](function.socket-close.html) зазнає невдачі і поверне помилку.

| array. Масив міститиме два ключі: lonoff та llinger. | | **`SO_OOBINLINE`** | Повідомляє, чи виходить `socket` із вбудованих даних. | int | | **`SO_SNDBUF`** | Повідомляє розмір надісланого буфера. | int | | **`SO_RCVBUF`** | Повідомляє розмір отриманого буфера. | int | | **`SO_ERROR`** | Повідомляє інформацію про статус помилки та очищає її. | int (не може бути встановлений [socket\_set\_option()](function.socket-set-option.html) **`SO_TYPE`** | Повідомляє про тип `socket` (наприклад, **`SOCK_STREAM`**). | int (не може бути встановлений [socket\_set\_option()](function.socket-set-option.html) **`SO_DONTROUTE`** | Повідомляє, що вихідні повідомлення оминають стандартні засоби маршрутизації. | int | | **`SO_RCVLOWAT`** | Повідомляє мінімальну кількість байтів для обробки операцій уведення `socket`. | int | | **`SO_RCVTIMEO`** | Повідомляє про значення часу очікування для операцій введення. | array. Масив міститиме два ключі: sec, який є частиною секунд для значення часу очікування та usec, який є мікросекундною частиною значення часу очікування. | | **`SO_SNDTIMEO`** | Повідомляє про значення часу очікування, що вказує кількість часу, який блокує функція виведення, оскільки керування потоком запобігає відправленню даних. | array. Масив міститиме два ключі: sec, який є частиною секунд для значення часу очікування та usec, який є мікросекундною частиною значення часу очікування. | | **`SO_SNDLOWAT`** | Повідомляє мінімальну кількість байтів для обробки операцією виводу `socket`. | int | | **`TCP_NODELAY`** | Повідомляє, чи відключено алгоритм Nagle TCP. | int | | **`MCAST_JOIN_GROUP`** | Приєднується до багатоадресної групи. | масив (array) із ключами `"group"`, вказавши рядок (string) з багатоадресною адресою IPv4 або IPv6 та `"interface"`, вказавши або номер інтерфейсу (тип int), або рядок (`string`) з ім'ям інтерфейсу, наприклад `"eth0"`. . `0` можна вказати, щоб повідомити, що інтерфейс має бути обраний за допомогою правил маршрутизації. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`MCAST_LEAVE_GROUP`** | Залишає багатоадресну групу. | масив (array). Дивіться **`MCAST_JOIN_GROUP`** для отримання додаткової інформації. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`MCAST_BLOCK_SOURCE`** | Блокує пакети, що надходять із певного джерела в певну групу багатоадресної передачі, які мають бути попередньо з'єднані. | масив (array) з такими ж ключами, як у **`MCAST_JOIN_GROUP`**плюс один додатковий ключ, `source`, який представляє рядок (string), що вказує IPv4 або IPv6 адресу джерела, який повинен бути заблокований. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`MCAST_UNBLOCK_SOURCE`** | Розблокує (починає прийом знову) пакети, що надходять з певної вихідної адреси певну групу багатоадресної передачі, яка повинна попередньо з'єднана. | масив (array) з таким самим форматом, як у **`MCAST_BLOCK_SOURCE`**. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`MCAST_JOIN_SOURCE_GROUP`** | Отримувати пакети, призначені для конкретної групи багатоадресної передачі, вихідна адреса якого збігається з певним значенням. | масив (array) з тим самим форматом, що у **`MCAST_BLOCK_SOURCE`**. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`MCAST_LEAVE_SOURCE_GROUP`** | Зупинити прийом пакетів, призначених для конкретної групи багатоадресної передачі, вихідна адреса якого збігається з певним значенням. | масив (array) з тим самим форматом, що у **`MCAST_BLOCK_SOURCE`**. (може використовуватися тільки в [socket\_set\_option()](function.socket-set-option.html) **`IP_MULTICAST_IF`** | Вихідний інтерфейс для багатоадресних пакетів IPv4. | Будь-яке ціле число (int), що вказує на номер інтерфейсу або рядок (string) з ім'ям інтерфейсу, наприклад, `eth0`. Значення 0 можна використовувати для вказівки, що таблиця маршрутизації використовується для вибору інтерфейсу. Функція **socketgetoption()** повертає індекс інтерфейсу. Зверніть увагу, що на відміну від C API, ця опція НЕ приймає IP-адресу. Це усуває різницю в інтерфейсі між **`IP_MULTICAST_IF`** і **`IPV6_MULTICAST_IF`**. **`IPV6_MULTICAST_IF`** | Вихідний інтерфейс для багатоадресних пакетів IPv6. | Те саме, що і **`IP_MULTICAST_IF`**. **`IP_MULTICAST_LOOP`** | Політика петлі групової передачі для пакетів IPv4, яка визначає, чи можуть пакети багатоадресної передачі, надіслані цим сокетом, також досягати приймачі на тому ж хості, які приєдналися до тієї ж групи багатоадресної передачі на інтерфейсі, що використовується цим сокетом. Це випадок за умовчанням. | ціле число (int) (або `0`, або `1`). Для [socket\_set\_option()](function.socket-set-option.html) Будь-яке значення буде прийнято і перетворено на тип boolean, згідно з звичайними правилами PHP. | | **`IPV6_MULTICAST_LOOP`** | Аналогічно **`IP_MULTICAST_LOOP`**, але для IPv6. | int. See **`IP_MULTICAST_LOOP`**. **`IP_MULTICAST_TTL`** | Час очікування вихідних пакетів IPv4 для багатоадресної передачі. Це має бути значення між 0 (не залишати інтерфейс) та 255. Значення за умовчанням - 1 (досягається лише локальна мережа). | ціле число (int) між 0 та 255. | | **`IPV6_MULTICAST_HOPS`** | Аналогічно **`IP_MULTICAST_TTL`**, але для пакетів IPv6. Значення -1 також приймається, що означає використання за промовчанням маршруту. | ціле число (int) між 0 та 255. | | **`SO_MARK`** | Встановлює ідентифікатор сокету для фільтрації пакетів у Linux. | int | | **`SO_ACCEPTFILTER`** | Додає фільтр прийому на сокет, що прослуховується (FreeBSD/NetBSD). Модуль ядра фільтра прийому має бути попередньо завантажений у FreeBSD (наприклад, accfhttp). | Рядок (string) - ім'я фільтра (довжина не більше 15). | | **`SO_USER_COOKIE`** | Встановлює ідентифікатор сокету для фільтрації пакетів FreeBSD. | int | | **`SO_DONTTRUNC`** | Зберігає непрочитані дані. | int | | **`SO_WANTMORE`** | Підказує, коли буде доступно більше даних. | int | | **`TCP_DEFER_ACCEPT`** | Не повідомляє слухач, поки дані не будуть готові. | int |

### Значення, що повертаються

Повертає значення заданої опції або **`false`** у разі виникнення помилки.

### список змін

| Версия | Описание                                                                                    |
|--------|---------------------------------------------------------------------------------------------|
|        | `socket` тепер екземпляр класу [Socket](class.socket.html); раніше був ресурсом (resource). |

### Приклади

**Приклад #1 Приклад використання **socketgetoption()****

```php
<?php
$socket = socket_create_listen(1223);

$linger = array('l_linger' => 1, 'l_onoff' => 1);
socket_set_option($socket, SOL_SOCKET, SO_LINGER, $linger);

var_dump(socket_get_option($socket, SOL_SOCKET, SO_REUSEADDR));
?>
```

### Дивіться також

-   [socket\_create\_listen()](function.socket-create-listen.html) - Відкриває сокет на вказаному порту для прийняття з'єднань
-   [socket\_set\_option()](function.socket-set-option.html) - Встановлює опції для сокету