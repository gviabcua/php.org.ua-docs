Підтримка Windows

-   [« Прочие изменения](migration71.other-changes.html)
    
-   [Миграция с PHP 5.6.x на PHP 7.0.x »](migration70.md)
    
-   [PHP Manual](index.md)
    
-   [Миграция с PHP 7.0.x на PHP 7.1.x](migration71.md)
    
-   Підтримка Windows
    

## Підтримка Windows

### Підтримка довгих та UTF-8 шляхів

Якщо веб-програма працює з UTF-8, жодних додаткових дій не потрібно. Для додатків, що здійснюють введення/виведення по шляхах, заданих у кодуванні відмінному від UTF-8, необхідно явно задати значення в INI-файлі. Перевірка кодувань здійснюється у такому порядку:

-   internalencoding
-   defaultcharset
-   zend.multibyte

Було введено кілька функцій для обробки кодових сторінок:

-   sapiwindowsспset() для встановлення кодування за замовчуванням
-   sapiwindowsспget() для отримання поточного кодування
-   sapiwindowsспісutf8()
-   sapiwindowsспconv() для конвертації між кодуваннями з використанням сигнатур аналогічним iconv()

Ці функції є потокобезпечними.

Кодова сторінка, яка використовується для виведення в консолі, налаштовується в залежності від кодування, що використовується в PHP. Залежно від конкретного системного OEM-кодування, видимий результат може бути коректним чи ні. Наприклад, у стандартній консолі cmd.exe у системах з кодуванням 437 OEM-виведення у кодуваннях 1251, 1252, 1253 та деяких інших може відображатися правильно при використанні UTF-8. У тих самих системах символи кодування типу 20932 будуть показані некоректно. Це стосується конкретних системних правил для кодової сторінки, сумісності шрифтів і конкретної консолі. PHP автоматично встановлює кодову сторінку консолі відповідно до правил кодування з php.ini. У деяких випадках використання консолі, відмінної від стандартної cmd.exe, може покращити ситуацію.

Не забувайте, що перемикання кодової сторінки під час виконання після запуску скрипту може призвести до несподіваних побічних ефектів CLI. Найкращий варіант - використовувати php.ini. При використанні PHP CLI в емуляторі консолі, який не підтримує Unicode, це може знадобитися, щоб уникнути зміни кодування консолі. Найкращий варіант - встановити кодування за умовчанням або внутрішнє кодування як ANSI. Також можна встановити директиви outputencoding та inputencoding у необхідні значення, але слід пам'ятати, що при відмінності внутрішнього кодування та кодування вводу/виводу ви, швидше за все, отримаєте кракозябри. У поодиноких випадках при падінні PHP, кодування консолі може не відновлюватися в початкове значення. У такому разі відновіть її самостійно за допомогою команди chcp.

Особливе зауваження для систем DBCS – перемикання кодування під час виконання за допомогою [iniset()](function.ini-set.html) може викликати проблеми з відображенням. Різниця із системами без DBCS полягає в тому, що розширені символи вимагають двох осередків консолі для відображення. У деяких випадках може відбутися лише відображення символів у гліфи поточного шрифту без його зміни. Це у характері систем DBCS. Найпростіший спосіб уникнути проблем із відображенням - відмовитися від використання [iniset()](function.ini-set.html) для зміни кодової сторінки.

В результаті підтримки UTF-8 у потоках, скрипти PHP більше не обмежені кодуванням ASCII та ANSI для імен файлів. Така підтримка доступна із коробки CLI. Для інших SAPI слід вивчити відповідну документацію.

Довгі шляхи підтримуються прозоро. Шляхи довші за 260 байт автоматично доповнюються префіксом `\\?\`. Максимальна довжина колії обмежена 2048 байт. Майте на увазі, що обмеження на довжину сегмента шляху (довжину базового імені), як і раніше, зберігаються.

Для кращої переносимості рекомендується обробляти імена файлів, введення/виведення та інші, пов'язані з UTF-8 сутності. Крім того, для консольних програм рекомендується використовувати шрифти TrueType і не рекомендується змінювати кодування за допомогою iniset().

### readline

Модуль [readline](book.readline.md) підтримується через бібліотеку [» WinEditLine](http://mingweditline.sourceforge.net/). Таким чином, інтерфейс оболонки CLI також підтримується (`php.exe -a`

### PHPFCGICHILDREN

Тепер береться до уваги PHPFCGICHILDREN. Якщо задана ця змінна оточення, то перший процес php-cgi.exe породить вказану кількість нащадків, які розділятимуть ті ж TCP-сокети.

### ftok()

Додана підтримка для [ftok()](function.ftok.md)