Обробляє конфігураційний файл

-   [« move\_uploaded\_file](function.move-uploaded-file.html)
    
-   [parse\_ini\_string »](function.parse-ini-string.html)
    
-   [PHP Manual](index.html)
    
-   [Функции файловой системы](ref.filesystem.html)
    
-   Обробляє конфігураційний файл
    

# parseinifile

(PHP 4, PHP 5, PHP 7, PHP 8)

parseinifile — Обробляє файл конфігурації

### Опис

```methodsynopsis
parse_ini_file(string $filename, bool $process_sections = false, int $scanner_mode = INI_SCANNER_NORMAL): array|false
```

**parseinifile()** завантажує ini-файл, вказаний у аргументі `filename`, і повертає його налаштування у вигляді асоціативного масиву.

Структура ini-файлу схожа структуру php.ini.

### Список параметрів

`filename`

Ім'я ini-файлу, що обробляється. Якщо використовується відносний шлях, він оцінюється щодо поточного робочого каталогу, а потім [include\_path](ini.core.html#ini.include-path)

`process_sections`

Встановивши параметр `process_sections` в **`true`**, Ви отримуєте багатовимірний масив, який включає як назву окремих налаштувань, так і секції. За замовчуванням `process_sections` дорівнює **`false`**

`scanner_mode`

Може приймати такі значення: **`INI_SCANNER_NORMAL`** (за замовчуванням) або **`INI_SCANNER_RAW`**. Якщо вказано значення **`INI_SCANNER_RAW`**то значення опцій не будуть оброблятися.

З версії PHP 5.6.1 можна також задати **`INI_SCANNER_TYPED`**. У цьому режимі типи boolean, null і integer, по можливості, зберігатимуться. Строкові значення `"true"` `"on"` і `"yes"` будуть перетворені на **`true`**. . `"false"` `"off"` `"no"` і `"none"` в **`false`**. . `"null"` перетворюється на **`null`**. Крім цього, усі числові рядки будуть, по можливості, перетворені до цілих чисел.

### Значення, що повертаються

У разі успішного виконання налаштування повертаються у вигляді асоціативного масиву (array). У разі виникнення помилки повертається **`false`**

### Приклади

**Приклад #1 Вміст sample.ini**

```
; Это пример файла настроек
; Комментарии начинаются с ';', как в php.ini

[first_section]
one = 1
five = 5
animal = BIRD

[second_section]
path = "/usr/local/bin"
URL = "http://www.example.com/~username"

[third_section]
phpversion[] = "5.0"
phpversion[] = "5.1"
phpversion[] = "5.2"
phpversion[] = "5.3"

urls[svn] = "http://svn.php.net"
urls[git] = "http://git.php.net"
```

**Приклад #2 Приклад використання функції **parseinifile()****

[Константы](language.constants.html) (але не "магічні константи" на кшталт **`__FILE__`**) також можуть оброблятися в ini-файлах, тому якщо ви оголосите константу у вигляді значення для ini-файла до виклику **parseinifile()**, то константа буде коректно опрацьована. Тільки значення опцій будуть оброблятись і значення має бути просто константою. Наприклад:

```php
<?php

define('BIRD', 'Птица додо');

// Обрабатываем без секций
$ini_array = parse_ini_file("sample.ini");
print_r($ini_array);

// Обрабатываем с секциями
$ini_array = parse_ini_file("sample.ini", true);
print_r($ini_array);

?>
```

Результатом виконання цього прикладу буде щось подібне:

```
Array
(
    [one] => 1
    [five] => 5
    [animal] => Птица додо
    [path] => /usr/local/bin
    [URL] => http://www.example.com/~username
    [phpversion] => Array
        (
            [0] => 5.0
            [1] => 5.1
            [2] => 5.2
            [3] => 5.3
        )

    [urls] => Array
        (
            [svn] => http://svn.php.net
            [git] => http://git.php.net
        )

)
Array
(
    [first_section] => Array
        (
            [one] => 1
            [five] => 5
            [animal] => Птица додо
        )

    [second_section] => Array
        (
            [path] => /usr/local/bin
            [URL] => http://www.example.com/~username
        )

    [third_section] => Array
        (
            [phpversion] => Array
                (
                    [0] => 5.0
                    [1] => 5.1
                    [2] => 5.2
                    [3] => 5.3
                )

            [urls] => Array
                (
                    [svn] => http://svn.php.net
                    [git] => http://git.php.net
                )

        )

)
```

**Приклад #3 Обробка файлу php.ini функцією **parseinifile()****

```php
<?php
// Простая функция для сравнения результатов
function yesno($expression)
{
    return($expression ? 'Да' : 'Нет');
}

// Получаем путь к php.ini с помощью функции php_ini_loaded_file()
$ini_path = php_ini_loaded_file();

// Обрабатываем php.ini
$ini = parse_ini_file($ini_path);

// Выводим и сравниваем значения, учтите, что использование get_cfg_var()
// даст одинаковые результаты для используемых здесь значений parsed (загруженное из файла) и loaded (используемое в данный момент)
echo '(parsed) magic_quotes_gpc = ' . yesno($ini['magic_quotes_gpc']) . PHP_EOL;
echo '(loaded) magic_quotes_gpc = ' . yesno(get_cfg_var('magic_quotes_gpc')) . PHP_EOL;
?>
```

Результатом виконання цього прикладу буде щось подібне:

```
(parsed) magic_quotes_gpc = Да
(loaded) magic_quotes_gpc = Да
```

**Приклад #4 Інтерполяція значень**

Крім оцінки констант, деякі символи мають особливе значення у значенні ini-файлів. Крім того, змінні середовища та раніше визначені параметри конфігурації (див. [get\_cfg\_var()](function.get-cfg-var.html)) можуть бути прочитані з використанням синтаксису `${}`

```
; | используется для побитового ИЛИ
three = 2|3

; & используется для побитового AND
four = 6&5

; ^ используется для побитового XOR
five = 3^6

; ~ используется для побитового отрицания
negative_two = ~1

; () используется для группировки
seven = (8|7)&(6|5)

path = ${PATH}
also_five = ${five}
```

**Приклад #5 Екранування символів**

Деякі символи мають особливе значення у рядках з подвійними лапками і мають бути екрановані префіксом зворотної косої межі. Насамперед, це подвійна лапка `"` як маркер кордону і сама зворотна коса риса `\` (якщо за нею слідує один із спеціальних символів):

```
quoted = "Она сказала \"Именно моя точка зрения\"." ; Результатом является строка с кавычками.
hint = "Используйте \\\", чтобы избежать двойных кавычек" ; Результат: Используйте \", чтобы избежать двойных кавычек
```

Для шляхів, подібних до Windows, зроблено виняток: можна не екранувати зворотну косу межу в кінці, якщо за рядком у лапках слідує розрив рядка:

```
save_path = "C:\Temp\"
```

Якщо потрібно екранувати подвійні лапки, за якими слід перенесення рядка в багаторядковому значенні, можна використовувати конкатенацію значень наступним чином (за одним рядком у подвійних лапках безпосередньо слідує інша):

```
long_text = "Lorem \"ipsum\"""
 dolor" ; Результат: Lorem "ipsum"\n dolor
```

Інший символ зі спеціальним значенням – це `$` (Знак долара). Він повинен бути екранований, якщо за ним слідує відкрита фігурна дужка:

```
code = "\${test}"
```

Екрануючі символи не підтримуються в режимі **`INI_SCANNER_RAW`** (у цьому режимі всі символи обробляються "як є").

Зверніть увагу, що синтаксичний аналізатор ini не підтримує стандартні послідовності екранування (`\n` `\t` і т.д.). За потреби виконайте постобробку результату **parseinifile()** за допомогою функції [stripcslashes()](function.stripcslashes.html)

### Примітки

> **Зауваження**
> 
> Ця функція не має жодного відношення до файлу php.ini. До моменту виконання вашого скрипта він вже оброблений. Ця функція може бути використана для завантаження налаштувань вашої власної програми.

> **Зауваження**
> 
> Якщо значення ini-файлу містить інші символи, окрім літер і цифр, воно повинне полягати в подвійних лапках (").

> **Зауваження**: Існує зарезервовані слова, які не можна використовувати як ключі в ini-файлах. Такими словами є: `null` `yes` `no` `true` `false` `on` `off` `none`. Значення `null` `off` `no` і `false` перетворюються на `""`, а значення `on` `yes` і `true` в `"1"` , але тільки якщо не використовується режим **`INI_SCANNER_TYPED`**. Символи `?{}|&~!()^"` не повинні використовуватися в ключах і мати будь-який особливий зміст у значеннях.

> **Зауваження**
> 
> Записи без рівня знаку ігноруються. Наприклад, "foo" ігнорується, тоді як "bar =" обробляється та додається з порожнім значенням. Наприклад, у MySQL є опція "no-auto-rehash", що встановлюється в my.cnf, яка не має значення та ігнорується.

> **Зауваження**
> 
> ini-файли зазвичай обробляються веб-серверами як простий текст і, таким чином, на запит передаються браузерам. Це означає, що з метою безпеки ви повинні або зберігати свої ini-файли поза кореневим каталогом документів, або переналаштувати веб-сервер, щоб вони не обслуговувалися. Невиконання будь-якої з цих вимог може спричинити загрозу безпеці.

### Дивіться також

-   [parse\_ini\_string()](function.parse-ini-string.html) - Розбирає рядок конфігурації