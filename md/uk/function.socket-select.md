---
navigation:
  - function.socket-recvmsg.md: « socket\_recvmsg
  - function.socket-send.md: socket\_send »
  - index.md: PHP Manual
  - ref.sockets.md: Опції сокету
title: socket\_select
origin_hash: ddf652f5224dc9f1fa9671347921941ca401ea50
---
# socket\_select

(PHP 4 >= 4.1.0, PHP 5, PHP 7, PHP 8)

socket\_select — Запускає системний виклик select() для заданих масивів сокетів із зазначеним часом очікування

### Опис

```methodsynopsis
socket_select(    ?array &$read,    ?array &$write,    ?array &$except,    ?int $seconds,    int $microseconds = 0): int|false
```

**socket\_select()** приймає масиви сокетів та чекає їх зміни статусу. Ті, хто знайомий із сокетами BSD, виявлять, що масиви сокетів насправді є так званими наборами дескрипторів файлів. Спостерігаються три незалежні масиви ресурсів сокетів.

### Список параметрів

`read`

Сокети, перелічені у масиві `read` будуть спостерігатися для перегляду, чи є доступні символи для читання (точніше, щоб бачити, чи не буде читання блокуватися, зокрема, сокет вже досяг кінця файлу, і в цьому випадку [socket\_read()](function.socket-read.md) поверне рядок із нульовою довжиною).

`write`

Сокети, перелічені у масиві `write` спостерігатимуться для перегляду, чи запис блокуватиметься.

`except`

Сокети, перелічені у масиві `except`будут наблюдаться для исключений.

`seconds`

`seconds`и`microseconds`вместе образуют параметр`timeout`Параметр`timeout` - максимальний проміжок часу до повернення **socket\_select()**. . `seconds` може бути нулем, змушуючи **socket\_select()** до негайного повернення. Це корисно для опитування. Якщо `seconds`равен\*\*`null`\*\*(нет времени ожидания),**socket\_select()** може блокуватися нескінченно.

`microseconds`

**Увага**

При завершенні масиви змінюються, щоб визначити, який сокет насправді змінив статус.

Не потрібно передавати кожен масив у **socket\_select()**. Ви можете пропустити його і використовувати порожній масив або **`null`** замість цього. Також не забувайте, що ці масиви передаються *за посиланням* і будуть змінені після завершення **socket\_select()**

> **Зауваження** :
> 
> Через обмеження поточного двигуна Zend неможливо передати модифікатор константи, такий як **`null`**, безпосередньо як параметр у функцію, яка очікує, що цей параметр буде передано за посиланням. Натомість використовуйте тимчасову змінну або вираз, де ліва сторона є тимчасовою змінною:
> 
> **Пример #1 Использование**`null`**в**socket\_select()\*\*\*\*
> 
> ```php
> <?php
> $e = NULL;
> socket_select($r, $w, $e, 0);
> ?>
> ```

### Значення, що повертаються

У разі успішного виконання **socket\_select()** повертає кількість сокетів, що містяться в змінених масивах, яка може дорівнювати нулю, якщо час очікування закінчиться до того, як станеться щось цікаве. У разі виникнення помилки повертається **`false`**. Код помилки може бути отриманий за допомогою [socket\_last\_error()](function.socket-last-error.md)

> **Зауваження** :
> 
> Обов'язково використовуйте оператор `===` під час перевірки на помилку. Оскільки **socket\_select()** може повертати 0, порівняння з `==` буде оцінюватися як **`true`** :
> 
> **Пример #2 Анализ результата**socket\_select()\*\*\*\*
> 
> ```php
> <?php
> $ e = NULL;
> if (false === socket_select($r, $w, $e, 0)) {
>     echo "Невдалий виклик socket_select(), причина: " .
>         socket_strerror(socket_last_error()) . "\n";
> }
> ?>
> ```

### Приклади

**Пример #3 Пример использования**socket\_select()\*\*\*\*

```php
<?php
/* Подготовить массив сокетов для чтения */
$read   = array($socket1, $socket2);
$write  = NULL;
$except = NULL;
$num_changed_sockets = socket_select($read, $write, $except, 0);

if ($num_changed_sockets === false) {
    /* Обработка ошибок */
} else if ($num_changed_sockets > 0) {
    /* По крайней мере, в одном из сокетов произошло что-то интересное */
}
?>
```

### Примітки

> **Зауваження** :
> 
> Майте на увазі, деякі реалізації сокетів необхідно обробляти дуже обережно. Декілька основних правил:
> 
> -   Ви завжди повинні спробувати використати\*\*socket\_select()\*\*без часу очікування. Ваша програма нічого не повинна робити, якщо немає доступних даних. Код, що залежить від часу очікування, зазвичай не дуже переносимий і важкий для налагодження.
> -   Сокет не повинен додаватися до будь-якого масиву, якщо ви не збираєтеся перевіряти результат після виклику**socket\_select()**. Після повернення\*\*socket\_select()\*\*всі сокети у всіх масивах мають бути перевірені. Будь-який сокет, доступний для запису чи читання, повинен використовуватися для запису чи читання.
> -   Якщо ви читаєте або записуєте з сокету, що повертається в масивах, майте на увазі, що він необов'язково зможе прочитати або записати дані, які ви запитуєте. Будьте готові прочитати або записати лише один байт.
> -   Зазвичай для більшості реалізацій сокетів єдиний виняток, упійманий за допомогою масиву`except`\- Це дані без прив'язки, отримані в сокеті.

### Дивіться також

-   [socket\_read()](function.socket-read.md) \- Читає рядок максимальну довжину байт із сокету
-   [socket\_write()](function.socket-write.md) \- Запис у сокет
-   [socket\_last\_error()](function.socket-last-error.md) \- Повертає останню помилку на сокеті
-   [socket\_strerror()](function.socket-strerror.md) \- Повертає рядок, що описує помилку сокету
