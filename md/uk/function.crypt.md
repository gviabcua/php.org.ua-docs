---
navigation:
  - function.crc32.html: « crc32
  - function.echo.html: echo »
  - index.html: PHP Manual
  - ref.strings.html: Функції для роботи з рядками
title: crypt
---
# crypt

(PHP 4, PHP 5, PHP 7, PHP 8)

crypt — Незворотне хешування рядка

**Увага**

Ця функція (поки що) небезпечна для обробки даних у двійковій формі!

### Опис

```methodsynopsis
crypt(string $string, string $salt): string
```

**crypt()** повертає хешований рядок, отриманий за допомогою стандартного алгоритму UNIX, заснованого на DES або іншого алгоритму. Функція [passwordverify()](function.password-verify.html) сумісна з **crypt()**. Отже, хеші паролів, створені **crypt()**, можуть бути використані в [passwordverify()](function.password-verify.html)

До версії PHP 8.0.0 параметр `salt` був необов'язковим. Однак функція **crypt()** створює слабкий хеш без параметра `salt`, а без нього видає помилку рівня **`E_NOTICE`**. Переконайтеся, що ви використовуєте досить складну сіль для кращої безпеки.

Функція [passwordhash()](function.password-hash.html) використовує складний хеш, генерує складну сіль і застосовує правильно кількість раундів хешування автоматично . [passwordhash()](function.password-hash.html) є простою обгорткою над **crypt()** та сумісна з існуючими хешами паролів. Тому вітається використання [passwordhash()](function.password-hash.html)

Вид хешування визначається переданим аргументом salt (сіль). Якщо сіль не вказана, буде автоматично згенерована стандартна випадкова двосимвольна (DES) або дванадцятисимвольна (MD5) сіль, залежно від доступності алгоритму MD5 crypt(). Обумовлена ​​константа **`CRYPT_SALT_LENGTH`** дозволяє визначити максимально доступну довжину солі відповідно до алгоритмів, що використовуються.

Стандартна функція **crypt()** на основі DES повертає сіль як перші два символи рядка, що повертається. Крім того, вона використовує лише перші вісім символів рядка `string`тому довгі рядки, що починаються з тих же восьми символів, згенерують один і той же результат (при використанні однакової солі).

Підтримуються такі типи хешей:

-   **`CRYPT_STD_DES`** - Стандартне DES-шифрування з двосимвольною сіллю з алфавіту "./0-9A-Za-z"./0-9A-Za-z". Використання інших символів у солі спричинить відмову роботи crypt().
-   **`CRYPT_EXT_DES`** - Розширене DES-шифрування. "Сіль" є 9-символьним рядком, що складається з символу підкреслення, за яким слідують 4 символи лічильника ітерації та 4 символи солі. Кожен із цих 4-символьних рядків кодує 24 біти, найменший символ першим. Значення від `0` до `63` кодуються як `./0-9A-Za-z`. Використання неприпустимих символів у солі призведе до помилки crypt().
-   **`CRYPT_MD5`** - MD5-шифрування з 12-символьною сіллю, що починається з $1$
-   **`CRYPT_BLOWFISH`** - Blowfish-шифрування з наступною сіллю: "$2a$", "$2x$" або "$2y$", ваговий параметр із двох цифр, "$" та 22 цифри з алфавіту "./0-9A-Za-z ". Використання інших символів у солі спричинить повернення порожнього рядка. Ваговий параметр з двох цифр є двійковим логарифмом лічильника ітерацій нижчележачого хешируючого алгоритму, заснованого на Blowfish, і повинен бути в діапазоні 04-31, значення поза даним діапазоном викликають відмову crypt(). Хеші "$2x$" потенційно слабкі; Хеші "$2a$" сумісні та пом'якшують цю слабкість. Для нових хешей слід використовувати $2y$.
-   **`CRYPT_SHA256`** - хеш SHA-256 з шістнадцятисимвольною сіллю, що починається з $5$. Якщо рядок із сіллю починається з 'rounds=$', число N буде використано для позначення кількості раундів хешування, за аналогією з ваговим параметром Blowfish. За замовчуванням кількість раундів дорівнює 5000, мінімально доступна 1000 і максимально 999,999,999. Будь-яке значення поза цим діапазоном буде усічено до найближчого ліміту.
-   **`CRYPT_SHA512`** - хеш SHA-512 з шістнадцятисимвольною сіллю, що починається з $6$. Якщо рядок із сіллю починається з 'rounds=$', число N буде використано для позначення кількості раундів хешування, за аналогією з ваговим параметром Blowfish. За замовчуванням кількість раундів дорівнює 5000, мінімально доступна 1000 і максимально 999,999,999. Будь-яке значення поза цим діапазоном буде усічено до найближчого ліміту.

### Список параметрів

`string`

Хешований рядок.

**Застереження**

При використанні алгоритму **`CRYPT_BLOWFISH`**, параметр `string` обрізається до 72 байт.

`salt`

Параметр із сіллю, на якій буде засновано хешування. Якщо не вказано, поведінка визначається за наявністю реалізованих алгоритмів у системі та може призвести до несподіваних результатів.

### Значення, що повертаються

Повертає хешований рядок або рядок коротше 13 символів, що гарантовано відрізняється від солі у разі виникнення помилки.

**Увага**

При валідації паролів повинні використовуватись функції порівняння рядків, стійкі до атаки за часом, для порівняння виведення функції **crypt()** із відомим хешом. У PHP для цього є функція [hashequals()](function.hash-equals.html)

### список змін

| Версия | Описание |
| --- | --- |
|  | `salt` більше не є необов'язковим. |

### Приклади

**Приклад #1 Приклад використання **crypt()****

```php
<?php
// соль будет сгенерирована автоматически; не рекомендуется
$hashed_password = crypt('mypassword');

/* Для проверки пароля в качестве параметра salt следует передавать результат работы
   crypt() целиком во избежание проблем при использовании различных
   алгоритмов (как уже было отмечено выше, стандартный DES-алгоритм
   использует 2-символьную соль, а MD5 - 12-символьную. */
if (hash_equals($hashed_password, crypt($user_input, $hashed_password))) {
   echo "Пароль верен!";
}
?>
```

**Приклад #2 Використання **crypt()** та htpasswd**

```php
<?php
// пароль
$password = 'mypassword';

// получение хеша, соль генерируется автоматически; не рекомендуется
$hash = crypt($password);
?>
```

**Приклад #3 Використання **crypt()** з різними видами хешей**

```php
<?php
/* Приведённая соль является только примером. Не используйте эту же соль в вашем коде.
   Вы должны сгенерировать уникальную и правильную соль для каждого пароля.
*/
echo 'Стандартный DES: ',
    crypt('rasmuslerdorf', 'rl'),
    "\n";
echo 'Расширенный DES: ',
    crypt('rasmuslerdorf', '_J9..rasm'),
    "\n";
echo 'MD5:          ',
    crypt('rasmuslerdorf', '$1$rasmusle$'),
    "\n";
echo 'Blowfish:     ',
    crypt('rasmuslerdorf', '$2a$07$usesomesillystringforsalt$'),
    "\n";
echo 'SHA-256:      ',
    crypt('rasmuslerdorf', '$5$rounds=5000$usesomesillystringforsalt$'),
    "\n";
echo 'SHA-512:      ',
    crypt('rasmuslerdorf', '$6$rounds=5000$usesomesillystringforsalt$'),
    "\n";
?>
```

Результатом виконання цього прикладу буде щось подібне:

```
Стандартный DES: rl.3StKT.4T8M
Расширенный DES: _J9..rasmBYk8r9AiWNc
MD5:          $1$rasmusle$rISCgZzpwk3UhDidwXvin0
Blowfish:     $2y$07$usesomesillystringfore2uDLvp1Ii2e./U9C8sBjqp8I90dH6hi
SHA-256:      $5$rounds=5000$usesomesillystri$KqJWpanXZHKq2BOB43TSaYhEWsQ1Lr5QNyPCDH/Tp.6
SHA-512:      $6$rounds=5000$usesomesillystri$D4IrlXatmP7rx3P3InaxBeoomnAihCKRVQP22JZ6EY47Wc6BkroIuUUBOov1i.S5KPgErtP/EN5mcO.ChWQW21
```

### Примітки

> **Зауваження**: Функція розшифровки відсутня. **crypt()** використовує незворотний алгоритм хешування.

### Дивіться також

-   [hashequals()](function.hash-equals.html) - Порівняння рядків, нечутливе до атак за часом
-   [passwordhash()](function.password-hash.html) - Створює хеш пароля
-   [md5()](function.md5.html) - Повертає MD5-хеш рядки
-   Сторінка керівництва Unix за вашою функцією crypt
