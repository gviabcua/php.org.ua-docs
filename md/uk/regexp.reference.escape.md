Екрануючі послідовності

-   [« Метасимволы](regexp.reference.meta.html)
    
-   [Властивості Unicode-символів »](regexp.reference.unicode.html)
    
-   [PHP Manual](index.html)
    
-   [Описание синтаксиса Perl-совместимых регулярных выражений](reference.pcre.pattern.syntax.html)
    
-   Екрануючі послідовності
    

## Екрануючі послідовності

Зворотня коса риса ('') має кілька застосувань. Насамперед, якщо вона передує не буквенно-цифровому символу, вона знімає з нього спеціальне значення, яке міг мати. Застосування зворотної косої риси як символу, що екранує, припустимо як у символьному класі, так і поза ним.

Наприклад, якщо ви хочете задати відповідність символу "", у шаблоні необхідно вказати "Це запобігатиме трактуванню наступного символу як метасимволу з особливим значенням. Завжди безпечно екранувати не буквено-цифрові символи за допомогою.", якщо ви хочете переконатися, що вони означають у шаблоні самих себе. В окремому випадку для порівняння з самим символом зворотної косої межі, використовуйте запис "".

> **Зауваження**
> 
> [PHP-рядки](language.types.string.html#language.types.string.syntax), Укладені в одинарні і подвійні лапки, по-особливому інтерпретують зворотну косу межу. Таким чином, якщо необхідно порівняти з регулярним виразом , у PHP-коді потрібно використовувати ""або"

У випадку, якщо вказано модифікатор [PCREEXTENDED](reference.pcre.pattern.modifiers.html), пробілові символи шаблону (поза описом символьного класу) ігноруються. Також ігнорується частина рядка, що знаходиться між символом "#" (знову ж таки, що не бере участі в описі символьного класу) і наступним символом перекладу рядка. У такому випадку зворотний сліш можна використовувати як символ, що екранує, для вказівки входжень пробельних символів або символу "#" у шаблоні.

Друге застосування зворотного сліша полягає в тому, що він дозволяє використовувати недруковані символи у видимій формі в описі шаблону. При тому, що в PCRE немає обмежень на використання недрукованих символів (за винятком бінарного нуля, який інтерпретується як кінець шаблону), при редагуванні програмного коду в якомусь текстовому редакторі набагато зручніше використовувати такі комбінації, ніж реальні символи, які вони представляють:

*а*

символ оповіщення, сигнал (BEL, шістнадцятковий код 07)

*сх*

"Ctrl+x", де x – довільний символ

*е*

escape (шістнадцятковий код 1B)

*ф*

розрив сторінки (шістнадцятковий код 0C)

*н*

переклад рядка (шістнадцятковий код 0A)

*p{xx}*

символ з властивістю xx, докладніше дивіться [свойства unicode](regexp.reference.unicode.html)

*P{xx}*

символ без властивості xx, докладніше дивіться [свойства unicode](regexp.reference.unicode.html)

*р*

повернення каретки (шістнадцятковий код 0D)

*Р*

розрив рядка: збігається з н, r та рн

*т*

табуляція (шістнадцятковий код 09)

*xhh*

символ з шістнадцятковим кодом hh

*ddd*

символ з вісімковим кодом ddd, або посилання на підмаску

Якщо бути точнішим, комбінація "`\cx`" інтерпретується так: якщо "`x`" - символ нижнього регістру, він перетворюється на верхній регістр. Після цього шостий біт символу (шістнадцятковий код 40) інвертується. Таким чином "`\cz`" інтерпретується як шістнадцяткове значення 1A, тоді як "`\c{`" отримує шістнадцяткове значення 3B, а "`\c;`\- 7B.

Після "`\x`зчитуються ще дві шістнадцяткові цифри (вони можуть бути записані в нижньому або верхньому регістрі). *режимі UTF-8*, дозволяється використання "`\x{...}`", де вміст дужок є рядком з шістнадцяткових цифр. Вона інтерпретується як символ UTF-8 character з кодом, що збігається з цим шістнадцятковим числом. Вихідна шістнадцяткова екрануюча послідовність, `\xhh`, збігається з двобайтним UTF-8 символом, якщо його значення перевищує 127.

Після "`\0`" зчитуються дві восьмеричні цифри. Якщо запису менше двох цифр, будуть використані все фактично присутні цифри. Таким чином, послідовність "`\0\x\07`" буде інтерпретована як два бінарних нулі, за якими слідує символ оповіщення (дзвінок). У разі, якщо ви використовуєте подання числа у вісімковому коді, переконайтеся, що за початковим нулем йдуть дві значущі цифри.

Обробка зворотного сліша, за яким слідує ненульова цифра, дещо складніше. Поза символьним класом PCRE сприймає зворотний слєш і такі цифри як десяткове число. Якщо отримане значення менше десяти, або якщо шаблон містить щонайменше таку кількість попередніх поточної позиції підмасок, вся конструкція інтерпретується як *посилання на підмаску*. Більш детальний опис буде наведено нижче під час обговорення механізму роботи підмасок.

Усередині символьного класу, або якщо отримане значення більше 9 і відповідна кількість попередніх підмасок відсутня, PCRE зчитує до трьох вісімкових цифр, що йдуть за зворотним слешем, і генерує один байт з останніх 8 значних бітів отриманого значення. Усі наступні цифри позначають себе. Наприклад:

ще один спосіб запису пробілу

те саме у випадку, якщо даному запису передує менше сорока підмасок

завжди інтерпретується як посилання на підмаску

може бути як зворотним посиланням, так і альтернативним записом символу табуляції

завжди інтерпретується як символ табуляції

символ табуляції, за яким слідує цифра "3"

інтерпретується як символ з вісімковим кодом 113 (оскільки посилань на підмаски не може бути більш ніж 99)

байт, що повністю складається з одиничних бітів

або зворотне посилання, або бінарний нуль, за яким йдуть цифри "8" і "1"

Слід пам'ятати, що вісімкові значення, що перевищують 100, слід писати без лідируючого нуля, тому що читається не більше трьох вісімкових цифр.

Усі послідовності, що визначають однобайтне значення, можуть зустрічатися як усередині, так і поза символьними класами. Крім того, всередині символьного класу запис "`\b`інтерпретується як символ повернення ('backspace', шістнадцятковий код 08). Поза символьним класом вона має інше значення (яке саме, описано нижче).

Третє використання зворотного сліша - вказівка ​​загального типу символів:

*д*

будь-яка десяткова цифра

*Д*

будь-який символ, крім десяткової цифри

*х*

будь-який горизонтальний символ пробілу

*Х*

будь-який символ, що не є горизонтальним символом пробілу

*з*

будь-який символ пробілу

*З*

будь-який непробільний символ

*в*

будь-який вертикальний символ пробілу

*У*

будь-який символ, що не є вертикальним символом пробілу

*в*

Будь-який символ, що утворює "слово"

*У*

Будь-який символ, що не утворює "слово"

Кожна пара таких спеціальних послідовностей ділить повну множину всіх символів на дві множини, що не перетинаються. Будь-який символ відповідає одній і тільки одній множині з пари.

Наступні символи вважаються "пробільні": HT (9), LF (10), FF (12), CR (13), і пробіл (32). Тим не менш, якщо йде локале-залежний пошук, і відбудеться збіг з символами в діапазоні 128-255, вони також будуть сприйняті як пробільні, наприклад, NBSP (A0).

Символ, що утворює "слово" - це довільна цифра, літера або символ підкреслення, простіше кажучи, будь-який символ, який може бути частиною.*слова*" Perl. Визначення букв і цифр управляється символьними таблицями, з якими було зібрано PCRE. І, як наслідок, ці набори можуть відрізнятися у різних локалізованих дистрибутивах. Наприклад, у локалі " fr " (Франція) деякі символи з кодом вище 128 використовуються для записи ударних символів і, відповідно, відповідають масці `\w`

Наведені вище типи символів можуть застосовуватися як усередині, так і поза символьними класами, і відповідають одному символу даного типу. Якщо поточна точка порівняння знаходиться в кінці рядка, жоден з них не зможе збігтися, тому що немає символу, з яким може статися збіг.

Четверте використання зворотного слєша - визначення деяких формальних тверджень, що описують умови щодо розташування особливих позицій у рядку і абсолютно не зачіпають самі символи. Використання підмасок як складніших формальних тверджень описано нижче. Такими керуючими послідовностями є:

*в*

межа слова

*У*

не є межею слова

*А*

початок даних (незалежно від багаторядкового режиму)

*З*

кінець даних чи позиція перед останнім перекладом рядка (незалежно від багаторядкового режиму)

*з*

кінець даних (незалежно від багаторядкового режиму)

*Г*

перша позиція, що збігається в рядку

Описані вище послідовності що неспроможні зустрічатися у символьних класах (крім комбінацію "`\b`", Що всередині класу означає символ повернення 'backspace').

Кордоном слова вважається така позиція у рядку, в якому з поточного та попереднього символу лише один відповідає `\w` або `\W` (тобто один з них відповідає `\w`, а інший `\W`). Початок або кінець рядка також відповідають межі слова у випадку, якщо перший або відповідно останній символ збігається з `\w`

Спеціальні послідовності `\A` `\Z` і `\z` відрізняються від загальновживаних метасимволів початку рядка '^' і кінця рядка '$' (описаних у розділі [якоря](regexp.reference.anchors.html)) тим, що вони завжди збігаються або на самому початку або наприкінці рядка. На них ніяк не впливають опції [PCREMULTILINE](reference.pcre.pattern.modifiers.html) і [PCREDOLLARENDONLY](reference.pcre.pattern.modifiers.html). Різниця між `\Z` і `\z` у тому, що `\Z` відповідає позиції перед останнім символом у разі, якщо останній символ - переклад рядка, крім кінця кінця рядка. В той час як `\z` відповідає виключно кінцю даних.

Твердження `\G` є дійсним лише в тому випадку, якщо поточна позиція, що перевіряється, знаходиться на початку збігу, вказаного параметром `offset` функції [pregmatch()](function.preg-match.html). Вона відрізняється від `\A` при ненульовому значенні параметра `offset`

`\Q` і `\E` можуть бути використані для ігнорування метасимволів регулярних виразів у шаблоні. Наприклад: `\w+\Q.$.\E$` збігається з один або більше символів, що становлять "слово", за якими слідують символи `.$.` і якір в кінці рядка. Зауважте, що це не змінює поведінки роздільників; наприклад, шаблон `#\Q#\E#$` некоректний, бо другий `#` відзначає кінець шаблону, а `\E#` інтерпретується як неприпустимі модифікатори.

Послідовність `\K` може бути використана для скидання початку збігу. Наприклад, шаблон `foo\Kbar` збігається з "foobar", але повідомить про те, що збігся тільки з "bar". Використання `\K` не заважає встановленню підмасок. Наприклад, якщо шаблон `(foo)\Kbar` збігається з рядком "foobar", першою підмаскою все одно буде "foo".