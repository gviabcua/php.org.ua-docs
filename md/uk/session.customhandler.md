Користувальницькі обробники сесії

-   [« Передача идентификатора сессии](session.idpassing.html)
    
-   [Отслеживание прогресса загрузки файлов с помощью сессий »](session.upload-progress.html)
    
-   [PHP Manual](index.html)
    
-   [Примеры](session.examples.html)
    
-   Користувальницькі обробники сесії
    

## Користувальницькі обробники сесії

Для реалізації сховища даних (або будь-якого іншого сховища) слід використовувати [session\_set\_save\_handler()](function.session-set-save-handler.html), щоб створити набір функцій користувача сховища. Обробники сесій можна створити, використовуючи клас [SessionHandlerInterface](class.sessionhandlerinterface.html), або розширити внутрішні обробники PHP, успадкувавши клас [SessionHandler](class.sessionhandler.html)

Функції зворотного дзвінка, зазначені в [session\_set\_save\_handler()](function.session-set-save-handler.html), є методами, що викликаються PHP протягом життєвого циклу сесії: `open` `read` `write` і `close` та для службових завдань: `destroy` для видалення сесії та `gc` для періодичного складання сміття.

Отже, у PHP завжди необхідні обробники, які зберігають сесії. За замовчуванням працює внутрішній обробник файлів, що зберігає сесії у файли. Користувальницький оброблювач може бути встановлений, використовуючи функцію [session\_set\_save\_handler()](function.session-set-save-handler.html). Альтернативні обробники для збереження сесії також доступні в PHP модулях, таких як `sqlite` `memcache` і `memcached` і можуть бути встановлені за допомогою [session.save\_handler](session.configuration.html#ini.session.save-handler)

Коли стартує сесія, PHP внутрішньо викличе обробник `open` з наступним викликом оброблювача `read`, який повинен повернути закодований рядок - точно такий, який передавався для збереження. Після повернення обробником `read` закодованого рядка, PHP декодує її і заповнить масивом, що вийшов, суперглобальний масив [$\_SESSION](reserved.variables.session.html)

Коли PHP завершує виконання скрипта (або коли викликана функція [session\_write\_close()](function.session-write-close.html)), PHP внутрішньо закодує суперглобальний масив [$\_SESSION](reserved.variables.session.html), та передасть ці дані з ідентифікатором сесії функції зворотного виклику `write`. Після того, як відпрацює функція зворотного дзвінка `write`, PHP внутрішньо викликає обробник функції зворотного виклику `close`

Коли сесія спеціально знищена, PHP викличе обробник `destroy` з ідентифікатором сесії

PHP буде викликати обробник функції зворотного виклику `gc` час від часу, щоб помітити сесії як минулі відповідно до часу життя сесій. Ця операція видаляє всі записи зі постійного сховища, доступ до яких не здійснювався більш ніж інтервал часу, зазначений у параметрі `$lifetime`