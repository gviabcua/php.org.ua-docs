Варіант 3: використання опцій docroot або userdir

-   [« Вариант 2: использование cgi.force\_redirect](security.cgi-bin.force-redirect.html)
    
-   [Вариант 4: PHP вне дерева веб-документов »](security.cgi-bin.shell.html)
    
-   [PHP Manual](index.html)
    
-   [Если PHP установлен как CGI](security.cgi-bin.html)
    
-   Варіант 3: використання опцій docroot або userdir
    

## Варіант 3: використання опцій docroot або userdir

Розміщення динамічного контенту, такого як скрипти або інших виконуваних файлів, в директорії веб-сервера робить його потенційно небезпечним. У випадку, якщо в конфігурації сервера допущена помилка, можлива ситуація, коли скрипти не виконуються, а відображаються в браузері, як звичайні HTML-документи, що може призвести до витоку конфіденційної інформації (наприклад, паролів) або інформації, яка є інтелектуальною власністю. Виходячи з таких міркувань, багато системних адміністраторів вважають за краще використовувати для зберігання скриптів окрему директорію, працюючи з усіма розміщеними в ній файлами за CGI-інтерфейсом.

Якщо неможливо гарантувати, що запити не перенаправляються, як було показано в попередньому розділі, необхідно вказувати змінну docroot, яка відрізняється від кореневої директорії веб-документів.

Ви можете встановити кореневу директорію для PHP-скриптів, налаштувавши параметр [doc\_root](ini.core.html#ini.doc-root) в [конфигурационном файле](configuration.file.html), або встановивши змінну оточення PHPDOCUMENTROOT. У випадку, якщо PHP використовується за допомогою CGI, повний шлях до файлу, що відкривається, буде побудований на підставі значення змінної `doc_root` та зазначеного у запиті шляху. Таким чином, ви можете бути впевнені, що скрипти будуть виконуватися тільки всередині вказаної директорії (крім директорії `user_dir`, Яка описана нижче).

Ще одна опція, що використовується при налаштуванні безпеки - [user\_dir](ini.core.html#ini.user-dir). Якщо змінна userdir не встановлена, шлях до файлу, що відкривається, будується відносно `doc_root`. Запит виду [http://my.host/~user/doc.php](http://my.host/~user/doc.php) призводить до виконання скрипта, що знаходиться не в домашньому каталозі відповідного користувача, а що знаходиться в підкаталозі docroot скрипта ~user/doc.php (так, ім'я директорії починається з символу \`~

Але якщо userdir встановлена, наприклад, значення publicphp, то запит виду [http://my.host/~user/doc.php](http://my.host/~user/doc.php) відкриє файл doc.php, що знаходиться в домашньому каталозі користувача, в директорії publicphp. Наприклад, якщо домашній каталог користувача /home/user, буде виконано файл /home/user/publicphp/doc.php

Встановлення опції `user_dir` відбувається незалежно від встановлення `doc_root`, таким чином ви можете контролювати кореневу директорію веб-сервера та користувальницькі директорії незалежно один від одного.