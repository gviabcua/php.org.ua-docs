Однорівневий пошук

-   [« ldapgetvalues](function.ldap-get-values.html)
    
-   [ldapmodaddext »](function.ldap-mod_add-ext.html)
    
-   [PHP Manual](index.md)
    
-   [Функції LDAP](ref.ldap.md)
    
-   Однорівневий пошук
    

# ldaplist

(PHP 4, PHP 5, PHP 7, PHP 8)

ldaplist — Однорівневий пошук

### Опис

```methodsynopsis
ldap_list(    LDAP\Connection|array $ldap,    array|string $base,    array|string $filter,    array $attributes = [],    int $attributes_only = 0,    int $sizelimit = -1,    int $timelimit = -1,    int $deref = LDAP_DEREF_NEVER,    ?array $controls = null): LDAP\Result|array|false
```

Виконує пошук для вказаного `filter` у директорії в рамках **`LDAP_SCOPE_ONELEVEL`**

**`LDAP_SCOPE_ONELEVEL`** означає, що пошук повинен повернути тільки інформацію, яка є наступним рівнем нижче `base`, заданого під час виклику. (еквівалент введення)**лс**" та отримання списку файлів та папок у поточному робочому каталозі.)

Можна також виконувати паралельний пошук. У цьому випадку першим аргументом має бути масив екземплярів [LDAPConnection](class.ldap-connection.html), а чи не один екземпляр. Якщо пошук не повинен використовувати один і той же базовий DN і фільтр, як аргументи можна передати масив базових DN і/або масив фільтрів. Кількість елементів у масивах має збігатися з кількістю екземплярів [LDAPConnection](class.ldap-connection.html)оскільки перші записи масивів використовуються для одного пошуку, другі - для іншого і так далі. При паралельному пошуку повертається масив екземплярів [LDAPResult](class.ldap-result.html), за винятком виникнення помилки, коли повертається значення **`false`**

### Список параметрів

`ldap`

Екземпляр [LDAPConnection](class.ldap-connection.html), що повертається функцією [ldapconnect()](function.ldap-connect.html)

`base`

Базове DN для каталогу.

`filter`

`attributes`

Масив необхідних атрибутів, наприклад, `array("mail", "sn", "cn")`. Зверніть увагу, що "dn" завжди повертається, незалежно від того, які типи атрибутів потрібні.

Використання цього параметра набагато ефективніше, ніж стандартна дія (яка повинна повернути всі атрибути та їх значення). Тому використання цього параметра слід вважати гарною практикою.

`attributes_only`

Повинен дорівнювати 1, тільки якщо потрібні типи атрибута. Якщо встановлено 0, за промовчанням вибираються і типи атрибутів і значення атрибута.

`sizelimit`

Дозволяє обмежити кількість вибраних записів. Налаштування цього параметра як 0 означає, що обмеження відсутнє.

> **Зауваження**
> 
> Цей параметр НЕ може перевизначати попереднє встановлення sizelimit на стороні сервера. Хоча його можна встановити нижче.
> 
> Деякі хости серверів каталогів будуть налаштовані так, щоб повернути не більше, ніж попередньо встановлена ​​кількість записів. Якщо це станеться, сервер вкаже, що повернув тільки частковий набір результатів. Це також відбувається, якщо Ви використовуєте цей параметр, щоб обмежити кількість вибраних записів.

`timelimit`

Встановлює кількість секунд, що обмежує процес пошуку. Налаштування цього параметра як 0 означає, що обмеження відсутнє.

> **Зауваження**
> 
> Цей параметр НЕ може перевизначати передустановку timelimit на стороні сервера. Хоча його можна встановити нижче.

`deref`

Визначає, як псевдоніми мають бути оброблені під час пошуку. Може бути одним із наступних:

-   **`LDAP_DEREF_NEVER`** - (за замовчуванням) псевдоніми ніколи не розіменовуються.
-   **`LDAP_DEREF_SEARCHING`** - псевдоніми мають бути розіменовані під час пошуку, але не при визначенні розташування базового об'єкта пошуку.
-   **`LDAP_DEREF_FINDING`** - псевдоніми мають бути розіменовані щодо місця розташування базового об'єкта, але з під час пошуку.
-   **`LDAP_DEREF_ALWAYS`** - псевдоніми повинні завжди розіменовуватись завжди.

`controls`

Масив [управляющих констант LDAP](ldap.controls.md) для відправки у запиті.

### Значення, що повертаються

Повертає екземпляр [LDAPResult](class.ldap-result.html), масив екземплярів [LDAPResult](class.ldap-result.html) або **`false`** у разі виникнення помилки.

### список змін

| Версия | Описание                                                                                                                                             |
|--------|------------------------------------------------------------------------------------------------------------------------------------------------------|
|        | Параметр `ldap` тепер чекає екземпляр [LDAPConnection](class.ldap-connection.html); раніше очікувався ресурс ([resource](language.types.resource.md) |
|        | Повертає екземпляр [LDAPResult](class.ldap-result.html); раніше повертався ресурс ([resource](language.types.resource.md)                            |
|        | `controls` тепер припускає значення null; раніше значення за умовчанням було `[]`                                                                    |
|        | Додано підтримку параметра `controls`                                                                                                                |

### Приклади

**Приклад #1 Виводить список усіх організаційних одиниць організації**

```php
<?php
// $ds допустимый экземпляр LDAP\Connection

$basedn = "o=My Company, c=US";
$justthese = array("ou");

$sr = ldap_list($ds, $basedn, "ou=*", $justthese);

$info = ldap_get_entries($ds, $sr);

for ($i=0; $i < $info["count"]; $i++) {
    echo $info[$i]["ou"][0];
}
?>
```

### Дивіться також

-   [ldapsearch()](function.ldap-search.html) - Пошук по LDAP дереву