---
navigation:
  - function.apcu-enabled.md: « apcu\_enabled
  - function.apcu-exists.md: apcu\_exists »
  - index.md: PHP Manual
  - ref.apcu.md: Функції APCu
title: apcu\_entry
origin_hash: ddf652f5224dc9f1fa9671347921941ca401ea50
---
# apcu\_entry

(PECL apcu >= 5.1.0)

apcu\_entry — Автоматичне вилучення або створення запису в кеші

### Опис

```methodsynopsis
apcu_entry(string $key, callable $generator, int $ttl = 0): mixed
```

Автоматично намагається знайти запис із заданим ключем `key`. Якщо не може, то викликається генератор `generator` і йому передається ключ `key` як єдиний аргумент. Згенероване значення заноситься в кеш із зазначеним `ttl` та повертається.

> **Зауваження**: Коли контроль передається **apcu\_entry()**, проводиться ексклюзивне блокування кешу, яке знімається після завершення роботи **apcu\_entry()**: це призводить до того, що тіло генератора `generator` міститься в критичну секцію, забороняючи двом процесам запустити виконання однакового коду конкурентно. До того ж, це призводить до заборони конкурентного запуску будь-яких інших функцій APCu, оскільки вони виставлятимуть те ж саме блокування.

**Увага**

Єдина функція APCu, яку можна безпечно викликати у генераторі `generator` - це **apcu\_entry()**

### Список параметрів

`key`

Ідентифікатор запису

`generator`

Callback-функция, принимающая один параметр`key` і повертає значення для кешування.

`ttl`

Время жизни; переменная`var` буде зберігатися протягом `ttl` секунд. Як тільки `ttl`секунд пройдут, переменная будет удалена из кеша (при следующем запросе). Если параметр`ttl`не задан (или`ttl`задан как ), значення буде зберігатися доки не буде видалено явно, або з технічної причини (очищення кешу, перезапуск і т.д.)

### Значення, що повертаються

Повертає закешоване значення

### Приклади

**Пример #1 Пример использования**apcu\_entry()\*\*\*\*

```php
<?php
$config = apcu_entry("config", function($key) {
 return [
   "fruit" => apcu_entry("config.fruit", function($key){
     return [
       "apples",
       "pears"
     ];
   }),
   "people" => apcu_entry("config.people", function($key){
     return [
      "bob",
      "joe",
      "niki"
     ];
   })
 ];
});

var_dump($config);
?>
```

Результат виконання наведеного прикладу:

```
array(2) {
  ["fruit"]=>
  array(2) {
    [0]=>
    string(6) "apples"
    [1]=>
    string(5) "pears"
  }
  ["people"]=>
  array(3) {
    [0]=>
    string(3) "bob"
    [1]=>
    string(3) "joe"
    [2]=>
    string(4) "niki"
  }
}
```

### Дивіться також

-   [apcu\_store()](function.apcu-store.md) \- Кешує змінну
-   [apcu\_fetch()](function.apcu-fetch.md) \- Витягує з кеша збережену змінну
-   [apcu\_delete()](function.apcu-delete.md) \- Видаляє збережене значення з кешу
