---
navigation:
  - function.com-load-typelib.html: « comloadtypelib
  - function.com-print-typeinfo.html: comprinttypeinfo »
  - index.md: PHP Manual
  - ref.com.md: Функции COM
title: commessagepump
---
# commessagepump

(PHP 4> = 4.2.0, PHP 5, PHP 7, PHP 8)

commessagepump — Обробка повідомлень COM, що прийшли не пізніше timeoutms мілісекунд після її запуску

### Опис

```methodsynopsis
com_message_pump(int $timeout_milliseconds = 0): bool
```

Функція "засинає" на `timeout_milliseconds` мілісекунд, або поки що в чергу не прийде нове повідомлення.

Призначення функції полягає у маршрутизації викликів COM між підрозділами та обробці різних асинхронних завдань. Вона дозволить вашому скрипту очікувати виникнення події, одночасно перехоплюючи інші події або виконуючи інший код у фоні. Ви повинні використовувати її в циклі, як показано на прикладі функції [comeventsink()](function.com-event-sink.md) до припинення використання прив'язки подій об'єкта COM.

### Список параметрів

`timeout_milliseconds`

Затримка у мілісекундах.

Якщо значення `timeout_milliseconds` не задано, воно буде вважатися рівним нулю. Це означає, що не буде затримки. Якщо при цьому є очікувана подія, то вона буде оброблена як завжди. Якщо події немає, то функція відразу ж поверне **`false`**

### Значення, що повертаються

Якщо повідомлення надійшло до вичерпання затримки, то вони будуть оброблені і функція поверне **`true`**. Якщо час затримки вийшов і жодного повідомлення не надійшло, то функція поверне **`false`**
