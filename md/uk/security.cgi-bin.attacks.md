Можливі атаки

-   [« Если PHP установлен как CGI](security.cgi-bin.html)
    
-   [Варіант 1: обслуговуються лише загальнодоступні файли »](security.cgi-bin.default.html)
    
-   [PHP Manual](index.html)
    
-   [Если PHP установлен как CGI](security.cgi-bin.html)
    
-   Можливі атаки
    

## Можливі атаки

Використання PHP як бінарного CGIПрограми є одним з варіантів, коли з яких-небудь причин небажано інтегрувати PHP у веб-сервер (наприклад, Apache) як модуль, або передбачається використання різних CGIобгорток та таких утиліт, як chroot та setuid для організації безпечного оточення роботи скриптів. Така установка зазвичай супроводжується копіюванням виконуваного файлу PHP до директорії cgi-bin веб-сервера. CERT (організація, яка стежить за загрозами безпеці) [» CA-96.11](http://www.cert.org/advisories/CA-1996-11.html) рекомендує не поміщати будь-які інтерпретатори до каталогу cgi-bin. Навіть якщо PHP використовується як самостійний інтерпретатор, він спроектований так, щоб запобігти наступним атакам:

-   Доступ до системних файлів: [http://my.host/cgi-bin/php?/etc/passwd](http://my.host/cgi-bin/php?/etc/passwd) Дані, введені в рядку запиту (URL) після знака запитання, передаються інтерпретатору як аргументи командного рядка за допомогою інтерфейсу CGI. Зазвичай інтерпретатори відкривають та виконують файл, зазначений як перший аргумент. У разі використання PHP як CGI-додатка він не інтерпретуватиме аргументи командного рядка.
-   Доступ до довільного документа на сервері: [http://my.host/cgi-bin/php/secret/doc.html](http://my.host/cgi-bin/php/secret/doc.html) Відповідно до загальноприйнятої угоди, частина шляху в запитаній сторінці, яка розташована після імені модуля PHP, /secret/doc.html, використовується для вказівки файлу, який буде інтерпретований CGIпрограмою. Зазвичай, деякі параметри конфігурації веб-сервера (наприклад, Action для сервера Apache) використовуються для перенаправлення документа, наприклад, для перенаправлення запитів виду [http://my.host/secret/script.php](http://my.host/secret/script.php) інтерпретатор PHP. У такому разі веб-сервер спочатку перевіряє права доступу до директорії /secret, і після цього створює перенаправлений запит [http://my.host/cgi-bin/php/secret/script.php](http://my.host/cgi-bin/php/secret/script.php). На жаль, якщо запит спочатку задано у повному вигляді, перевірка на наявність прав для файлу /secret/script.php не виконується, вона відбувається лише для файлу /cgi-bin/php. Таким чином, користувач може звернутися до /cgi-bin/php, і, як наслідок, до будь-якого захищеного документа на сервері. Якщо в PHP вказати під час виконання скрипту опції [cgi.forceredirect](ini.core.html#ini.cgi.force-redirect) [docroot](ini.core.html#ini.doc-root) і [userdir](ini.core.html#ini.user-dir), то можна запобігти подібним атакам для директорій з обмеженим доступом. Більш детально наведені опції та їх комбінації будуть розглянуті нижче.